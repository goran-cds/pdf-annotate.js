{"version":3,"sources":["webpack://PDFAnnotate/webpack/universalModuleDefinition","webpack://PDFAnnotate/webpack/bootstrap","webpack://PDFAnnotate/./node_modules/events/events.js","webpack://PDFAnnotate/./src/utils/abstractFunction.js","webpack://PDFAnnotate/./src/utils/setAttributes.js","webpack://PDFAnnotate/./src/utils/normalizeColor.js","webpack://PDFAnnotate/./src/render/renderPoint.js","webpack://PDFAnnotate/./src/render/renderRect.js","webpack://PDFAnnotate/./src/render/renderStamp.js","webpack://PDFAnnotate/./src/render/renderText.js","webpack://PDFAnnotate/./src/render/renderCircle.js","webpack://PDFAnnotate/./src/utils/mathUtils.js","webpack://PDFAnnotate/./src/render/renderArrow.js","webpack://PDFAnnotate/./src/render/appendChild.js","webpack://PDFAnnotate/./src/render/renderLine.js","webpack://PDFAnnotate/./src/render/renderPath.js","webpack://PDFAnnotate/./src/UI/utils.js","webpack://PDFAnnotate/./src/UI/event.js","webpack://PDFAnnotate/./src/adapter/StoreAdapter.js","webpack://PDFAnnotate/./src/utils/uuid.js","webpack://PDFAnnotate/./src/adapter/LocalStoreAdapter.js","webpack://PDFAnnotate/./src/adapter/LocalUserStoreAdapter.js","webpack://PDFAnnotate/./src/config.js","webpack://PDFAnnotate/./src/UI/edit.js","webpack://PDFAnnotate/./src/UI/pen.js","webpack://PDFAnnotate/./src/UI/arrow.js","webpack://PDFAnnotate/./src/UI/eraser.js","webpack://PDFAnnotate/./src/UI/point.js","webpack://PDFAnnotate/./src/UI/rect.js","webpack://PDFAnnotate/./src/UI/circle.js","webpack://PDFAnnotate/./src/UI/text.js","webpack://PDFAnnotate/./src/a11y/createScreenReaderOnly.js","webpack://PDFAnnotate/./src/a11y/insertElementWithinElement.js","webpack://PDFAnnotate/./src/a11y/insertElementWithinChildren.js","webpack://PDFAnnotate/./src/a11y/insertScreenReaderComment.js","webpack://PDFAnnotate/./src/a11y/renderScreenReaderComments.js","webpack://PDFAnnotate/./src/a11y/insertScreenReaderHint.js","webpack://PDFAnnotate/./src/a11y/initEventHandlers.js","webpack://PDFAnnotate/./src/a11y/renderScreenReaderHints.js","webpack://PDFAnnotate/./src/UI/page.js","webpack://PDFAnnotate/./src/UI/index.js","webpack://PDFAnnotate/./src/PDFJSAnnotate.js","webpack://PDFAnnotate/./src/render/index.js","webpack://PDFAnnotate/./index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","EventEmitter","init","this","once","emitter","Promise","resolve","reject","errorListener","err","removeListener","resolver","slice","arguments","eventTargetAgnosticAddListener","handler","flags","on","addErrorHandlerIfEventEmitter","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","type","prepend","events","existing","warning","newListener","emit","unshift","push","length","warned","w","Error","String","count","console","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","arr","ret","Array","unwrapListeners","arrayClone","listenerCount","copy","addEventListener","wrapListener","arg","removeEventListener","set","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","message","context","len","listeners","addListener","prependListener","prependOnceListener","list","position","originalListener","shift","index","pop","spliceOne","off","removeAllListeners","keys","rawListeners","eventNames","abstractFunction","UPPER_REGEX","BLACKLIST","setAttributes","node","attributes","forEach","setAttribute","indexOf","replace","match","toLowerCase","keyCase","REGEX_HASHLESS_HEX","normalizeColor","color","test","SIZE","createRect","rect","document","createElementNS","x","y","width","height","renderStamp","a","rectangles","fill","stroke","renderText","text","fontSize","size","transform","rotation","style","textElement","textContent","_step","lines","split","getAttribute","_iterator","_createForOfIteratorHelper","done","line","tspan","toString","innerHTML","appendChild","e","f","insertLineBreaks","content","g","renderCircle","circle","group","cx","cy","createCircle","translate","rotate","angle","Math","PI","cosValue","cos","sinValue","sin","scale","makePoint","z","makeVector","xcoord","ycoord","zcoord","makeVectorFromPoints","pt1","pt2","addVector","pt","v","multiplyVector","scalar","magnitude","sqrt","pow","negateVector","unitVector","mag","renderArrow","u","arrow","p1","p2","pt0","unitX","unitZ","unitY","thickness","A","B","C","D","G","F","E","points","isFirefox","navigator","userAgent","getTranslation","viewport","trans","nodeName","parseInt","path","querySelector","svg","parentNode","assign","annotation","child","JSON","parse","fillOpacity","renderRect","strokeWidth","x1","y1","x2","y2","outerSVG","innerSVG","viewBox","renderPoint","join","renderPath","uuid","filter","transformChild","BORDER_COLOR","userSelectStyleSheet","createElement","findSVGContainer","toUpperCase","findSVGAtPoint","elements","querySelectorAll","el","pointIntersectsRect","getBoundingClientRect","findAnnotationAtPoint","candidate","elementFromPoint","top","bottom","left","right","getOffsetAnnotationRect","extraOffsetWidth","extraOffsetHeight","tagName","getBBox","bbox","_getOffset","offsetLeft","offsetTop","getOffset","scaleUp","result","getMetadata","convertToSvgPoint","xform","offset","convertToScreenPoint","scaleDown","disableUserSelect","head","enableUserSelect","removeChild","documentId","pageNumber","clickNode","fireEvent","clientX","clientY","StoreAdapter","_this","definition","_classCallCheck","__getAnnotations","fn","then","annotations","annotationId","__addAnnotation","__editAnnotation","__deleteAnnotation","success","__addComment","comment","commentId","__deleteComment","REGEXP","replacement","random","LocalStoreAdapter","_StoreAdapter","_callSuper","getAnnotations","page","getAnnotation","findAnnotation","addAnnotation","updateAnnotations","editAnnotation","deleteAnnotation","splice","getComments","addComment","class","deleteComment","_inherits","localStorage","getItem","setItem","stringify","LocalUserStoreAdapter","userId","globalEdit","getAllAnnotations","_userId","_globalEdit","all_annotations","re","RegExp","search","_toConsumableArray","annotationLayerName","textLayerName","annotationSvgQuery","annotationClassQuery","textClassQuery","overlay","dragOffsetX","dragOffsetY","dragStartX","dragStartY","_enabled","isDragging","destroyEditOverlay","handleDocumentClick","handleDocumentKeyup","handleDocumentMousedown","handleDocumentMousemove","handleDocumentMouseup","config","PDFJSAnnotate","getStoreAdapter","getElementById","keyTest","keyCode","preventDefault","background","cursor","display","maxY","maxX","offsetHeight","offsetWidth","attribX","attribY","modelStart","modelEnd","modelDelta","firstChild","modelX","modelY","setTimeout","handleAnnotationClick","anchor","id","styleLeft","styleTop","boxSizing","border","borderRadius","zIndex","padding","textAlign","textDecoration","borderColor","boxShadow","createEditOverlay","_penSize","_penColor","_candraw","handleDocumentPointerdown","handleDocumentPointerup","_getMetadata","saveToStorage","handleDocumentPointermove","point","toFixed","savePoint","originY","originX","_getMetadata2","_canerase","previousPoint","handleDocumentDown","handleDocumentUp","erase","handleDocumentMouseMove","check","diffX","abs","diffY","maxSteps","round","max","subStepSize","min","smallerTest","startPoint","_i","_check","parentElement","input","handleInputBlur","handleInputKeyup","body","focus","closeInput","trim","_type","rects","getSelection","getRangeAt","getClientRects","getSelectionRects","saveRect","map","removeAllRanges","boundingRect","convertToSvgRect","_circleRadius","_circleColor","radius","svg_pt","saveCircle","_textSize","_textColor","srcElement","classList","contains","saveText","shiftKey","createScreenReaderOnly","createTextNode","overflow","insertElementWithinElement","insertBefore","textLayerElementFromPoint","temp","cloneNode","tail","outerHTML","insertElementWithinChildren","nodes","textLayer","insertScreenReaderComment","item","renderScreenReaderComments","comments","isArray","COMMENT_TYPES","reorderAnnotationsByType","removeAnnotation","renderScreenReaderHints","removeElementById","insertComment","removeComment","elementId","SORT_TYPES","sortBy","sort","num","first","last","includes","insertScreenReaderHint","sortByPoint","b","sortByRectPoint","lineA","lineB","PAGE_TEMPLATE","approximateFraction","floor","xinv","x_","q","roundToDivide","div","disableEdit","enableEdit","disablePen","enablePen","setPen","penSize","penColor","parseFloat","disablePoint","enablePoint","disableRect","enableRect","disableCircle","enableCircle","setCircle","circleColor","addCircle","oldType","disableArrow","enableArrow","setArrow","disableEraser","enableEraser","disableText","enableText","setText","textColor","createPage","children","canvas","mozOpaque","renderPage","renderOptions","pdfDocument","pdfjsViewer","EventBus","all","getPage","_ref","_ref2","_slicedToArray","pdfPage","canvasContext","getContext","alpha","totalRotation","getViewport","wrapper","outputScale","ctx","devicePixelRatio","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","pixelRatio","sx","sy","scaled","sfx","sfy","visibility","scalePage","render","promise","getTextContent","normalizeWhitespace","__storeAdapter","setStoreAdapter","adapter","UI","data","removeAttribute","_this$getStoreAdapter"],"mappings":"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","file":"pdf-annotate.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PDFAnnotate\"] = factory();\n\telse\n\t\troot[\"PDFAnnotate\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","/**\n * Throw an Error for an abstract function that hasn't been implemented.\n *\n * @param {String} name The name of the abstract function\n */\nexport default function abstractFunction(name) {\n  throw new Error(name + ' is not implemented');\n}\n","const UPPER_REGEX = /[A-Z]/g;\n\n// Don't convert these attributes from camelCase to hyphenated-attributes\nconst BLACKLIST = [\n  'viewBox'\n];\n\nlet keyCase = (key) => {\n  if (BLACKLIST.indexOf(key) === -1) {\n    key = key.replace(UPPER_REGEX, match => '-' + match.toLowerCase());\n  }\n  return key;\n};\n\n/**\n * Set attributes for a node from a map\n *\n * @param {Node} node The node to set attributes on\n * @param {Object} attributes The map of key/value pairs to use for attributes\n */\nexport default function setAttributes(node, attributes) {\n  Object.keys(attributes).forEach((key) => {\n    node.setAttribute(keyCase(key), attributes[key]);\n  });\n}\n","const REGEX_HASHLESS_HEX = /^([a-f0-9]{6}|[a-f0-9]{3})$/i;\n\n/**\n * Normalize a color value\n *\n * @param {String} color The color to normalize\n * @return {String}\n */\nexport default function normalizeColor(color) {\n  if (REGEX_HASHLESS_HEX.test(color)) {\n    color = `#${color}`;\n  }\n  return color;\n}\n","import setAttributes from '../utils/setAttributes';\n\nconst SIZE = 25;\nconst D = 'M499.968 214.336q-113.832 0 -212.877 38.781t-157.356 104.625 -58.311 142.29q0 62.496 39.897 119.133t112.437 97.929l48.546 27.9 -15.066 53.568q-13.392 50.778 -39.06 95.976 84.816 -35.154 153.45 -95.418l23.994 -21.204 31.806 3.348q38.502 4.464 72.54 4.464 113.832 0 212.877 -38.781t157.356 -104.625 58.311 -142.29 -58.311 -142.29 -157.356 -104.625 -212.877 -38.781z';\n\n/**\n * Create SVGElement from an annotation definition.\n * This is used for anntations of type `comment`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGElement} A svg to be rendered\n */\nexport default function renderPoint(a) {\n  let outerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n  let innerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n  let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n  let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n\n  setAttributes(outerSVG, {\n    width: SIZE,\n    height: SIZE,\n    x: a.x,\n    y: a.y\n  });\n\n  setAttributes(innerSVG, {\n    width: SIZE,\n    height: SIZE,\n    x: 0,\n    y: (SIZE * 0.05) * -1,\n    viewBox: '0 0 1000 1000'\n  });\n\n  setAttributes(rect, {\n    width: SIZE,\n    height: SIZE,\n    stroke: '#000',\n    fill: '#ff0'\n  });\n\n  setAttributes(path, {\n    d: D,\n    strokeWidth: 50,\n    stroke: '#000',\n    fill: '#fff'\n  });\n\n  innerSVG.appendChild(path);\n  outerSVG.appendChild(rect);\n  outerSVG.appendChild(innerSVG);\n\n  return outerSVG;\n}\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGRectElements from an annotation definition.\n * This is used for anntations of type `area` and `highlight`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGGElement|SVGRectElement} A group of all rects to be rendered\n */\nexport default function renderRect(a) {\n  if (a.type === 'highlight') {\n    let group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n    setAttributes(group, {\n      fill: normalizeColor(a.color || '#ff0'),\n      fillOpacity: 0.2\n    });\n\n    a.rectangles.forEach((r) => {\n      group.appendChild(createRect(r));\n    });\n\n    return group;\n  }\n  else {\n    let rect = createRect(a);\n    setAttributes(rect, {\n      stroke: normalizeColor(a.color || '#f00'),\n      fill: 'none'\n    });\n\n    return rect;\n  }\n}\n\nfunction createRect(r) {\n  let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n\n  setAttributes(rect, {\n    x: r.x,\n    y: r.y,\n    width: r.width,\n    height: r.height\n  });\n\n  return rect;\n}\n","import setAttributes from \"../utils/setAttributes\";\nimport normalizeColor from \"../utils/normalizeColor\";\n/**\n * Create an SVGRectElement from an annotation definition.\n * This is used for annotations of type `stamp`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGRectElement} A rectangle to be rendered\n */\nexport default function renderStamp(a) {\n  let rect = createRect(a);\n  let color = normalizeColor(a.color || \"#FFFF00\"); // Default color for stamp\n\n  setAttributes(rect, {\n    fill: color,\n    stroke: color,\n    \"stroke-width\": 1, // Optional: a border stroke width\n  });\n\n  return rect;\n}\n\n/**\n * Create an SVGRectElement with the given attributes.\n *\n * @param {Object} a The annotation definition\n * @return {SVGRectElement} A rectangle element\n */\nfunction createRect(a) {\n  let rect = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\n  setAttributes(rect, {\n    x: a.rectangles[0].x,\n    y: a.rectangles[0].y,\n    width: a.rectangles[0].width,\n    height: a.rectangles[0].height,\n  });\n\n  return rect;\n}\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Wrap each line of given text in a `<tspan>` element and append these\n * lines to the given SVGTextElement\n *\n * @param {SVGTextElement} textElement A text element to hold the split text\n * @param {String} textContent String to render with line breaks\n */\nfunction insertLineBreaks(textElement, textContent) {\n  const lines = (textContent || '').split('\\n');\n  // can't use dy attribute here since we want empty lines to take up space as well,\n  // so we will update y manually based on font size\n  const x = textElement.getAttribute('x');\n  let y = Number(textElement.getAttribute('y'));\n  const size = Number(textElement.getAttribute('font-size'));\n  for (const line of lines) {\n    const tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan');\n    tspan.setAttribute('y', y.toString());\n    tspan.setAttribute('x', x);\n    tspan.innerHTML = line;\n    textElement.appendChild(tspan);\n\n    y += size;\n  }\n}\n\n/**\n * Create SVGTextElement from an annotation definition.\n * This is used for anntations of type `textbox`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGTextElement} A text to be rendered\n */\nexport default function renderText(a) {\n  // Text should be rendered at 0 degrees relative to\n  // document rotation\n  let text = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n  setAttributes(text, {\n    x: a.x,\n    y: a.y,\n    fill: normalizeColor(a.color || '#000'),\n    fontSize: a.size,\n    transform: `rotate(${a.rotation})`,\n    style: 'white-space: pre'\n  });\n\n  insertLineBreaks(text, a.content);\n\n  let g = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n  g.appendChild(text);\n\n  return g;\n}\n","import setAttributes from \"../utils/setAttributes\";\nimport normalizeColor from \"../utils/normalizeColor\";\n\n/**\n * Create an SVGCircleElement from an annotation definition.\n * This is used for annotations of type `circle`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGGElement|SVGCircleElement} A circle to be rendered\n */\nexport default function renderCircle(a) {\n  let circle = createCircle(a);\n  let color = normalizeColor(a.color || \"#f00\");\n\n  if (a.type === \"circle\") {\n    setAttributes(circle, {\n      stroke: color,\n      fill: \"none\",\n      \"stroke-width\": 5,\n    });\n  }\n  if (a.type === \"emptycircle\") {\n    setAttributes(circle, {\n      stroke: color,\n      fill: \"none\",\n      \"stroke-width\": 2,\n    });\n  }\n\n  return circle;\n}\n\nfunction createCircle(a) {\n  let group = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n\n  let rect = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\n  setAttributes(rect, {\n    x: a.cx - 30,\n    y: a.cy - 15,\n    width: 60,\n    height: 30,\n    fill: \"#fef18b\",\n  });\n\n  // Append the shape to the group\n  group.appendChild(rect);\n\n  // Add a hardcoded text element\n  let text = document.createElementNS(\"http://www.w3.org/2000/svg\", \"text\");\n  setAttributes(text, {\n    x: a.cx,\n    y: a.cy,\n    \"font-size\": 8,\n    \"text-anchor\": \"middle\",\n    \"dominant-baseline\": \"middle\",\n    fill: \"#854d0f\",\n  });\n  text.textContent = \"Sign here\";\n\n  group.appendChild(text);\n\n  return group;\n}\n","// Transform point by matrix\n//\nexport function applyTransform(p, m) {\n  return [\n    p[0] * m[0] + p[1] * m[2] + m[4],\n    p[0] * m[1] + p[1] * m[3] + m[5]\n  ];\n};\n\n// Transform point by matrix inverse\n//\nexport function applyInverseTransform(p, m) {\n  let d = m[0] * m[3] - m[1] * m[2];\n  return [\n    (p[0] * m[3] - p[1] * m[2] + m[2] * m[5] - m[4] * m[3]) / d,\n    (-p[0] * m[1] + p[1] * m[0] + m[4] * m[1] - m[5] * m[0]) / d\n  ];\n};\n\n// Concatenates two transformation matrices together and returns the result.\nexport function transform(m1, m2) {\n  return [\n    m1[0] * m2[0] + m1[2] * m2[1],\n    m1[1] * m2[0] + m1[3] * m2[1],\n    m1[0] * m2[2] + m1[2] * m2[3],\n    m1[1] * m2[2] + m1[3] * m2[3],\n    m1[0] * m2[4] + m1[2] * m2[5] + m1[4],\n    m1[1] * m2[4] + m1[3] * m2[5] + m1[5]\n  ];\n};\n\nexport function translate(m, x, y) {\n  return [\n    m[0],\n    m[1],\n    m[2],\n    m[3],\n    m[0] * x + m[2] * y + m[4],\n    m[1] * x + m[3] * y + m[5]\n  ];\n};\n\nexport function rotate(m, angle) {\n  angle = angle * Math.PI / 180;\n\n  let cosValue = Math.cos(angle);\n  let sinValue = Math.sin(angle);\n\n  return [\n    m[0] * cosValue + m[2] * sinValue,\n    m[1] * cosValue + m[3] * sinValue,\n    m[0] * (-sinValue) + m[2] * cosValue,\n    m[1] * (-sinValue) + m[3] * cosValue,\n    m[4],\n    m[5]\n  ];\n};\n\nexport function scale(m, x, y) {\n  return [\n    m[0] * x,\n    m[1] * x,\n    m[2] * y,\n    m[3] * y,\n    m[4],\n    m[5]\n  ];\n};\n\nexport function makePoint(x, y, z) {\n  return { x: x, y: y, z: z };\n};\n\nexport function makeVector(xcoord, ycoord, zcoord) {\n  return { xcoord: xcoord, ycoord: ycoord, zcoord: zcoord };\n};\n\nexport function makeVectorFromPoints(pt1, pt2) {\n  let xcoord = pt2.x - pt1.x;\n  let ycoord = pt2.y - pt1.y;\n  let zcoord = pt2.z - pt1.z;\n  return makeVector(xcoord, ycoord, zcoord);\n};\n\nexport function addVector(pt, v) {\n  return makePoint(pt.x + v.xcoord, pt.y + v.ycoord, pt.z + v.zcoord);\n};\n\nexport function multiplyVector(v, scalar) {\n  return makeVector(v.xcoord * scalar, v.ycoord * scalar, v.zcoord * scalar);\n};\n\nexport function magnitude(v) {\n  return Math.sqrt(\n    Math.pow(v.xcoord, 2) + Math.pow(v.ycoord, 2) + Math.pow(v.zcoord, 2)\n  );\n};\n\nexport function negateVector(v) {\n  return multiplyVector(v, -1);\n};\n\nexport function unitVector(v) {\n  let mag = magnitude(v);\n  let xcoord = v.xcoord / mag;\n  let ycoord = v.ycoord / mag;\n  let zcoord = v.zcoord / mag;\n  return makeVector(xcoord, ycoord, zcoord);\n};\n\nexport function crossProduct(u, v) {\n  //\n  // u X v = < u2*v3 - u3*v2,\n  //           u3*v1 - u1*v3,\n  //           u1*v2 - u2*v1 >\n  let xcoord = u.ycoord * v.zcoord - u.zcoord * v.ycoord;\n  let ycoord = u.zcoord * v.xcoord - u.xcoord * v.zcoord;\n  let zcoord = u.xcoord * v.ycoord - u.ycoord * v.xcoord;\n  return makeVector(xcoord, ycoord, zcoord);\n};\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\nimport {\n  makePoint, makeVector, makeVectorFromPoints,\n  magnitude, unitVector, crossProduct,\n  addVector, multiplyVector, negateVector\n} from '../utils/mathUtils';\n\n/**\n * Create SVGPathElement from an annotation definition.\n * This is used for anntations of type `drawing`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGPathElement} The path to be rendered\n */\nexport default function renderArrow(a) {\n  let arrow = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');\n\n  if (a.lines.length === 2) {\n    let p1 = a.lines[0];\n    let p2 = a.lines[a.lines.length - 1];\n\n    let arrowLength = 40;\n    let pt0 = makePoint(p1[0], p1[1], 0);\n    let pt1 = makePoint(p2[0], p2[1], 0);\n    let x = makeVectorFromPoints(pt0, pt1);\n    let unitX = unitVector(x);\n    pt1 = addVector(pt0, multiplyVector(unitX, arrowLength));\n    x = makeVectorFromPoints(pt0, pt1);\n    let unitZ = makeVector(0, 0, 1);\n    let unitY = unitVector(crossProduct(unitX, unitZ));\n    let thickness = a.width || 10;\n\n    let A = addVector(pt0, multiplyVector(unitY, thickness * 0.5));\n    let B = addVector(A, multiplyVector(unitX, magnitude(x) - thickness * 2.0));\n    let C = addVector(B, multiplyVector(unitY, thickness));\n    let D = pt1;\n    let G = addVector(pt0, multiplyVector(negateVector(unitY), thickness * 0.5));\n    let F = addVector(G, multiplyVector(unitX, magnitude(x) - thickness * 2.0));\n    let E = addVector(F, multiplyVector(negateVector(unitY), thickness));\n\n    let points = '' +\n      A.x + ',' + A.y + ' ' +\n      B.x + ',' + B.y + ' ' +\n      C.x + ',' + C.y + ' ' +\n      D.x + ',' + D.y + ' ' +\n      E.x + ',' + E.y + ' ' +\n      F.x + ',' + F.y + ' ' +\n      G.x + ',' + G.y;\n\n    setAttributes(arrow, {\n      points: points,\n      stroke: normalizeColor(a.color || '#000'),\n      fill: normalizeColor(a.color || '#000')\n    });\n  }\n\n  return arrow;\n}\n","import renderLine from \"./renderLine\";\nimport renderPath from \"./renderPath\";\nimport renderPoint from \"./renderPoint\";\nimport renderRect from \"./renderRect\";\nimport renderStamp from \"./renderStamp\";\nimport renderText from \"./renderText\";\nimport renderCircle from \"./renderCircle\";\nimport renderArrow from \"./renderArrow\";\n\nconst isFirefox = /firefox/i.test(navigator.userAgent);\n\n/**\n * Get the x/y translation to be used for transforming the annotations\n * based on the rotation of the viewport.\n *\n * @param {Object} viewport The viewport data from the page\n * @return {Object}\n */\nexport function getTranslation(viewport) {\n  let x;\n  let y;\n\n  // Modulus 360 on the rotation so that we only\n  // have to worry about four possible values.\n  switch (viewport.rotation % 360) {\n    case 0:\n      x = y = 0;\n      break;\n    case 90:\n      x = 0;\n      y = (viewport.width / viewport.scale) * -1;\n      break;\n    case 180:\n      x = (viewport.width / viewport.scale) * -1;\n      y = (viewport.height / viewport.scale) * -1;\n      break;\n    case 270:\n      x = (viewport.height / viewport.scale) * -1;\n      y = 0;\n      break;\n  }\n\n  return { x, y };\n}\n\n/**\n * Transform the rotation and scale of a node using SVG's native transform attribute.\n *\n * @param {Node} node The node to be transformed\n * @param {Object} viewport The page's viewport data\n * @return {Node}\n */\nfunction transform(node, viewport) {\n  let trans = getTranslation(viewport);\n\n  // Let SVG natively transform the element\n  node.setAttribute(\n    \"transform\",\n    `scale(${viewport.scale}) rotate(${viewport.rotation}) translate(${trans.x}, ${trans.y})`\n  );\n\n  // Manually adjust x/y for nested SVG nodes\n  if (!isFirefox && node.nodeName.toLowerCase() === \"svg\") {\n    node.setAttribute(\n      \"x\",\n      parseInt(node.getAttribute(\"x\"), 10) * viewport.scale\n    );\n    node.setAttribute(\n      \"y\",\n      parseInt(node.getAttribute(\"y\"), 10) * viewport.scale\n    );\n\n    let x = parseInt(node.getAttribute(\"x\", 10));\n    let y = parseInt(node.getAttribute(\"y\", 10));\n    let width = parseInt(node.getAttribute(\"width\"), 10);\n    let height = parseInt(node.getAttribute(\"height\"), 10);\n    let path = node.querySelector(\"path\");\n    let svg = path.parentNode;\n\n    // Scale width/height\n    [node, svg, path, node.querySelector(\"rect\")].forEach((n) => {\n      n.setAttribute(\n        \"width\",\n        parseInt(n.getAttribute(\"width\"), 10) * viewport.scale\n      );\n      n.setAttribute(\n        \"height\",\n        parseInt(n.getAttribute(\"height\"), 10) * viewport.scale\n      );\n    });\n\n    // Transform path but keep scale at 100% since it will be handled natively\n    transform(path, Object.assign({}, viewport, { scale: 1 }));\n\n    switch (viewport.rotation % 360) {\n      case 90:\n        node.setAttribute(\"x\", viewport.width - y - width);\n        node.setAttribute(\"y\", x);\n        svg.setAttribute(\"x\", 1);\n        svg.setAttribute(\"y\", 0);\n        break;\n      case 180:\n        node.setAttribute(\"x\", viewport.width - x - width);\n        node.setAttribute(\"y\", viewport.height - y - height);\n        svg.setAttribute(\"y\", 2);\n        break;\n      case 270:\n        node.setAttribute(\"x\", y);\n        node.setAttribute(\"y\", viewport.height - x - height);\n        svg.setAttribute(\"x\", -1);\n        svg.setAttribute(\"y\", 0);\n        break;\n    }\n  }\n\n  return node;\n}\n\n/**\n * Append an annotation as a child of an SVG.\n *\n * @param {SVGElement} svg The SVG element to append the annotation to\n * @param {Object} annotation The annotation definition to render and append\n * @param {Object} viewport The page's viewport data\n * @return {SVGElement} A node that was created and appended by this function\n */\nexport function appendChild(svg, annotation, viewport) {\n  if (!viewport) {\n    viewport = JSON.parse(svg.getAttribute(\"data-pdf-annotate-viewport\"));\n  }\n\n  let child;\n  switch (annotation.type) {\n    case \"area\":\n    case \"highlight\":\n      child = renderRect(annotation);\n      break;\n    case \"circle\":\n    case \"fillcircle\":\n    case \"emptycircle\":\n      child = renderCircle(annotation);\n      break;\n    case \"strikeout\":\n      child = renderLine(annotation);\n      break;\n    case \"point\":\n      child = renderPoint(annotation);\n      break;\n    case \"textbox\":\n      child = renderText(annotation);\n      break;\n    case \"drawing\":\n      child = renderPath(annotation);\n      break;\n    case \"arrow\":\n      child = renderArrow(annotation);\n    case \"stamp\":\n      child = renderStamp(annotation);\n      break;\n      break;\n  }\n\n  // If no type was provided for an annotation it will result in node being null.\n  // Skip appending/transforming if node doesn't exist.\n  if (child) {\n    // Set attributes\n    child.setAttribute(\"data-pdf-annotate-id\", annotation.uuid);\n    child.setAttribute(\"aria-hidden\", true);\n\n    // Dynamically set any other attributes associated with annotation that is not related to drawing it\n    Object.keys(annotation)\n      .filter((key) => {\n        return (\n          [\n            \"color\",\n            \"x\",\n            \"y\",\n            \"cx\",\n            \"cy\",\n            \"color\",\n            \"documentId\",\n            \"lines\",\n            \"page\",\n            \"width\",\n            \"class\",\n            \"content\",\n            \"size\",\n            \"rotation\",\n            \"r\",\n          ].indexOf(key) === -1\n        );\n      })\n      .forEach((key) => {\n        child.setAttribute(`data-pdf-annotate-${key}`, annotation[key]);\n      });\n\n    svg.appendChild(transform(child, viewport));\n  }\n\n  return child;\n}\n\n/**\n * Transform a child annotation of an SVG.\n *\n * @param {SVGElement} svg The SVG element with the child annotation\n * @param {Object} child The SVG child to transform\n * @param {Object} viewport The page's viewport data\n * @return {SVGElement} A node that was transformed by this function\n */\nexport function transformChild(svg, child, viewport) {\n  if (!viewport) {\n    viewport = JSON.parse(svg.getAttribute(\"data-pdf-annotate-viewport\"));\n  }\n\n  // If no type was provided for an annotation it will result in node being null.\n  // Skip transforming if node doesn't exist.\n  if (child) {\n    child = transform(child, viewport);\n  }\n\n  return child;\n}\n\nexport default {\n  /**\n   * Get the x/y translation to be used for transforming the annotations\n   * based on the rotation of the viewport.\n   */\n  getTranslation,\n\n  /**\n   * Append an SVG child for an annotation\n   */\n  appendChild,\n\n  /**\n   * Transform an existing SVG child\n   */\n  transformChild,\n};\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGLineElements from an annotation definition.\n * This is used for anntations of type `strikeout`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGGElement} A group of all lines to be rendered\n */\nexport default function renderLine(a) {\n  let group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n  setAttributes(group, {\n    stroke: normalizeColor(a.color || '#f00'),\n    strokeWidth: 1\n  });\n\n  a.rectangles.forEach((r) => {\n    let line = document.createElementNS('http://www.w3.org/2000/svg', 'line');\n\n    setAttributes(line, {\n      x1: r.x,\n      y1: r.y,\n      x2: r.x + r.width,\n      y2: r.y\n    });\n\n    group.appendChild(line);\n  });\n\n  return group;\n}\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGPathElement from an annotation definition.\n * This is used for anntations of type `drawing`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGPathElement} The path to be rendered\n */\nexport default function renderPath(a) {\n  let d = [];\n  let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n\n  if (a.lines.length > 0) {\n    d.push(`M${a.lines[0][0]} ${a.lines[0][1]}`);\n    for (let i = 1, l = a.lines.length; i < l; i++) {\n      let p1 = a.lines[i];\n      let p2 = a.lines[i + 1];\n      if (p2) {\n        d.push(`L${p1[0]} ${p1[1]}`);\n      }\n    }\n  }\n\n  /*\n\n   if(a.lines.length>2) {\n    var p1 = a.lines[0];\n    var p2 = a.lines[a.lines.length-1];\n\n    var p3 = []; //arrow\n    var p4 = [];\n    var p0 = []; //arrow intersection\n\n    if (p2) {\n      var k = -(p2[0]-p1[0])/(p2[1]-p1[1]);\n\n      var deltaX = 3;\n      p0[0] = p1[0]+0.8*(p2[0]-p1[0]);\n      p0[1] = p1[1]+0.8*(p2[1]-p1[1]);\n\n      p3[0] = p0[0] + deltaX;\n      p3[1] = p0[1] + k*deltaX;\n\n      p4[0] = p0[0] - deltaX;\n      p4[1] = p0[1] - k*deltaX;\n\n      if(Math.abs(p2[1]-p1[1]) < 20) {\n\n        p3[0] = p0[0] ;\n        p3[1] = p0[1] + deltaX*1;\n\n        p4[0] = p0[0] ;\n        p4[1] = p0[1] - deltaX*1;\n\n      }\n\n      d.push(`M${p1[0]} ${p1[1]} ${p2[0]} ${p2[1]}`);\n       //d.push(`M${p1[0]} ${p1[1]} ${p2[0]} ${p2[1]}`);\n      d.push(`M${p2[0]} ${p2[1]} ${p3[0]} ${p3[1]}`);\n      d.push(`M${p3[0]} ${p3[1]} ${p4[0]} ${p4[1]}`);\n      d.push(`M${p4[0]} ${p4[1]} ${p2[0]} ${p2[1]}`);\n     }\n    } */\n\n  setAttributes(path, {\n    d: `${d.join(' ')}`, // `${d.join(' ')}Z`,\n    stroke: normalizeColor(a.color || '#000'),\n    strokeWidth: a.width || 1,\n    fill: 'none'\n  });\n\n  return path;\n}\n","import { getTranslation } from '../render/appendChild';\nimport {\n  applyTransform,\n  applyInverseTransform,\n  translate,\n  rotate,\n  scale\n} from '../utils/mathUtils';\n\nexport const BORDER_COLOR = '#00BFFF';\n\nconst userSelectStyleSheet = document.createElement('style');\nuserSelectStyleSheet.innerHTML = `\nbody {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n`;\n\nuserSelectStyleSheet.setAttribute('data-pdf-annotate-user-select', 'true');\n\n/**\n * Find the SVGElement that contains all the annotations for a page\n *\n * @param {Element} node An annotation within that container\n * @return {SVGElement} The container SVG or null if it can't be found\n */\nexport function findSVGContainer(node) {\n  let parentNode = node;\n\n  while ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n    if (parentNode.nodeName.toUpperCase() === 'SVG' &&\n        parentNode.getAttribute('data-pdf-annotate-container') === 'true') {\n      return parentNode;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Find an SVGElement container at a given point\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @return {SVGElement} The container SVG or null if one can't be found\n */\nexport function findSVGAtPoint(x, y) {\n  let elements = document.querySelectorAll('svg[data-pdf-annotate-container=\"true\"]');\n\n  for (let i = 0, l = elements.length; i < l; i++) {\n    let el = elements[i];\n    let rect = el.getBoundingClientRect();\n\n    if (pointIntersectsRect(x, y, rect)) {\n      return el;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Find an Element that represents an annotation at a given point.\n *\n * IMPORTANT: Requires the annotation layer to be the top most element so\n *            either use z-ordering or make it the leaf container.\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @return {Element} The annotation element or null if one can't be found\n */\nexport function findAnnotationAtPoint(x, y) {\n  let el = null;\n  let candidate = document.elementFromPoint(x, y);\n  while (!el && candidate && candidate !== document) {\n    let type = candidate.getAttribute('data-pdf-annotate-type');\n    if (type) {\n      el = candidate;\n    }\n    candidate = candidate.parentNode;\n  }\n  return el;\n}\n\n/**\n * Determine if a point intersects a rect\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Object} rect The points of a rect (likely from getBoundingClientRect)\n * @return {Boolean} True if a collision occurs, otherwise false\n */\nexport function pointIntersectsRect(x, y, rect) {\n  return y >= rect.top && y <= rect.bottom && x >= rect.left && x <= rect.right;\n}\n\n/**\n * Get the rect of an annotation element accounting for offset.\n *\n * @param {Element} el The element to get the rect of\n * @return {Object} The dimensions of the element\n */\nexport function getOffsetAnnotationRect(el) {\n  let rect = el.getBoundingClientRect();\n  let { width, height } = rect;\n  let extraOffsetWidth = 0;\n  let extraOffsetHeight = 0;\n  if (['line', 'path'].indexOf(el.tagName.toLowerCase()) > -1 && el.getBBox) {\n    let bbox = el.getBBox();\n    extraOffsetWidth = (rect.width - bbox.width) / 2;\n    extraOffsetHeight = (rect.height - bbox.height) / 2;\n    width = bbox.width;\n    height = bbox.height;\n  }\n  let { offsetLeft, offsetTop } = getOffset(el);\n  return {\n    top: rect.top - offsetTop + extraOffsetHeight,\n    left: rect.left - offsetLeft + extraOffsetWidth,\n    bottom: rect.bottom - offsetTop - extraOffsetHeight,\n    right: rect.right - offsetLeft - extraOffsetWidth,\n    width: width,\n    height: height\n  };\n}\n\n/**\n * Adjust scale from normalized scale (100%) to rendered scale.\n *\n * @param {SVGElement} svg The SVG to gather metadata from\n * @param {Object} rect A map of numeric values to scale\n * @return {Object} A copy of `rect` with values scaled up\n */\nexport function scaleUp(svg, rect) {\n  let result = {};\n  let { viewport } = getMetadata(svg);\n\n  Object.keys(rect).forEach((key) => {\n    result[key] = rect[key] * viewport.scale;\n  });\n\n  return result;\n}\n\nexport function convertToSvgRect(rect, svg, viewport) {\n  let pt1 = [rect.x, rect.y];\n  let pt2 = [rect.x + rect.width, rect.y + rect.height];\n\n  pt1 = convertToSvgPoint(pt1, svg, viewport);\n  pt2 = convertToSvgPoint(pt2, svg, viewport);\n\n  return {\n    x: Math.min(pt1[0], pt2[0]),\n    y: Math.min(pt1[1], pt2[1]),\n    width: Math.abs(pt2[0] - pt1[0]),\n    height: Math.abs(pt2[1] - pt1[1])\n  };\n}\n\nexport function convertToSvgPoint(pt, svg, viewport) {\n  viewport = viewport || getMetadata(svg).viewport;\n\n  let xform = [ 1, 0, 0, 1, 0, 0 ];\n  xform = scale(xform, viewport.scale, viewport.scale);\n  xform = rotate(xform, viewport.rotation);\n\n  let offset = getTranslation(viewport);\n  xform = translate(xform, offset.x, offset.y);\n\n  return applyInverseTransform(pt, xform);\n}\n\nexport function convertToScreenPoint(pt, svg, viewport) {\n  viewport = viewport || getMetadata(svg).viewport;\n\n  let xform = [ 1, 0, 0, 1, 0, 0 ];\n  xform = scale(xform, viewport.scale, viewport.scale);\n  xform = rotate(xform, viewport.rotation);\n\n  let offset = getTranslation(viewport);\n  xform = translate(xform, offset.x, offset.y);\n\n  return applyTransform(pt, xform);\n}\n\n/**\n * Adjust scale from rendered scale to a normalized scale (100%).\n *\n * @param {SVGElement} svg The SVG to gather metadata from\n * @param {Object} rect A map of numeric values to scale\n * @return {Object} A copy of `rect` with values scaled down\n */\nexport function scaleDown(svg, rect) {\n  let result = {};\n  let { viewport } = getMetadata(svg);\n\n  Object.keys(rect).forEach((key) => {\n    result[key] = rect[key] / viewport.scale;\n  });\n\n  return result;\n}\n\n/**\n * Get the scroll position of an element, accounting for parent elements\n *\n * @param {Element} el The element to get the scroll position for\n * @return {Object} The scrollTop and scrollLeft position\n */\nexport function getScroll(el) {\n  let scrollTop = 0;\n  let scrollLeft = 0;\n  let parentNode = el;\n\n  while ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n    scrollTop += parentNode.scrollTop;\n    scrollLeft += parentNode.scrollLeft;\n  }\n\n  return { scrollTop, scrollLeft };\n}\n\n/**\n * Get the offset position of an element, accounting for parent elements\n *\n * @param {Element} el The element to get the offset position for\n * @return {Object} The offsetTop and offsetLeft position\n */\nexport function getOffset(el) {\n  let parentNode = el;\n\n  while ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n    if (parentNode.nodeName.toUpperCase() === 'SVG') {\n      break;\n    }\n  }\n\n  let rect = parentNode.getBoundingClientRect();\n\n  return { offsetLeft: rect.left, offsetTop: rect.top };\n}\n\n/**\n * Disable user ability to select text on page\n */\nexport function disableUserSelect() {\n  if (!userSelectStyleSheet.parentNode) {\n    document.head.appendChild(userSelectStyleSheet);\n  }\n}\n\n/**\n * Enable user ability to select text on page\n */\nexport function enableUserSelect() {\n  if (userSelectStyleSheet.parentNode) {\n    userSelectStyleSheet.parentNode.removeChild(userSelectStyleSheet);\n  }\n}\n\n/**\n * Get the metadata for a SVG container\n *\n * @param {SVGElement} svg The SVG container to get metadata for\n */\nexport function getMetadata(svg) {\n  return {\n    documentId: svg.getAttribute('data-pdf-annotate-document'),\n    pageNumber: parseInt(svg.getAttribute('data-pdf-annotate-page'), 10),\n    viewport: JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'))\n  };\n}\n","import EventEmitter from 'events';\nimport {\n  findAnnotationAtPoint,\n  findSVGAtPoint\n} from './utils';\n\nconst emitter = new EventEmitter();\n\nlet clickNode;\n\n/**\n * Handle document.click event\n *\n * @param {Event} e The DOM event to be handled\n */\ndocument.addEventListener('click', function handleDocumentClick(e) {\n  if (!findSVGAtPoint(e.clientX, e.clientY)) {\n    return;\n  }\n\n  let target = findAnnotationAtPoint(e.clientX, e.clientY);\n\n  // Emit annotation:blur if clickNode is no longer clicked\n  if (clickNode && clickNode !== target) {\n    emitter.emit('annotation:blur', clickNode);\n  }\n\n  // Emit annotation:click if target was clicked\n  if (target) {\n    emitter.emit('annotation:click', target);\n  }\n\n  clickNode = target;\n});\n\n// let mouseOverNode;\n// document.addEventListener('mousemove', function handleDocumentMousemove(e) {\n//   let target = findAnnotationAtPoint(e.clientX, e.clientY);\n//\n//   // Emit annotation:mouseout if target was mouseout'd\n//   if (mouseOverNode && !target) {\n//     emitter.emit('annotation:mouseout', mouseOverNode);\n//   }\n//\n//   // Emit annotation:mouseover if target was mouseover'd\n//   if (target && mouseOverNode !== target) {\n//     emitter.emit('annotation:mouseover', target);\n//   }\n//\n//   mouseOverNode = target;\n// });\n\nexport function fireEvent() { emitter.emit(...arguments); };\nexport function addEventListener() { emitter.on(...arguments); };\nexport function removeEventListener() { emitter.removeListener(...arguments); };\n","// Disable JSDoc as it cannot really deal with the odd way that the functions are defined\n/* eslint valid-jsdoc: 0 */\n\nimport abstractFunction from '../utils/abstractFunction';\nimport { fireEvent } from '../UI/event';\n\n// Adapter should never be invoked publicly\nexport default class StoreAdapter {\n  /**\n   * Create a new StoreAdapter instance\n   *\n   * @param {Object} [definition] The definition to use for overriding abstract methods\n   */\n  constructor(definition = {}) {\n    // Copy each function from definition if it is a function we know about\n    Object.keys(definition).forEach((key) => {\n      if (typeof definition[key] === 'function' &&\n          typeof this[key] === 'function') {\n        this[key] = definition[key];\n      }\n    });\n  }\n\n  /**\n   * Get all the annotations for a given document and page number.\n   *\n   * @param {String} documentId The ID for the document the annotations belong to\n   * @param {Number} pageNumber The number of the page the annotations belong to\n   * @return {Promise} Promise that returns with list of annotations for document and page\n   */\n  __getAnnotations(documentId, pageNumber) { abstractFunction('getAnnotations'); }\n  get getAnnotations() { return this.__getAnnotations; }\n  set getAnnotations(fn) {\n    this.__getAnnotations = function getAnnotations(documentId, pageNumber) {\n      return fn(...arguments).then((annotations) => {\n        // TODO may be best to have this happen on the server\n        if (annotations.annotations) {\n          annotations.annotations.forEach((a) => {\n            a.documentId = documentId;\n          });\n        }\n        return annotations;\n      });\n    };\n  }\n\n  /**\n   * Get the definition for a specific annotation.\n   *\n   * @param {String} documentId The ID for the document the annotation belongs to\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise} Promise that returns the requested annotation\n   */\n  getAnnotation(documentId, annotationId) { abstractFunction('getAnnotation'); }\n\n  /**\n   * Add an annotation\n   *\n   * @param {String} documentId The ID for the document to add the annotation to\n   * @param {String} pageNumber The page number to add the annotation to\n   * @param {Object} annotation The definition for the new annotation\n   * @return {Promise} Promise that returns with the added annotation\n   */\n  __addAnnotation(documentId, pageNumber, annotation) { abstractFunction('addAnnotation'); }\n  get addAnnotation() { return this.__addAnnotation; }\n  set addAnnotation(fn) {\n    this.__addAnnotation = function addAnnotation(documentId, pageNumber, annotation) {\n      return fn(...arguments).then((annotation) => {\n        fireEvent('annotation:add', documentId, pageNumber, annotation);\n        return annotation;\n      });\n    };\n  }\n\n  /**\n   * Edit an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} pageNumber the page number of the annotation\n   * @param {Object} annotation The definition of the modified annotation\n   * @return {Promise} Promise that returns with the edited annotation\n   */\n  __editAnnotation(documentId, pageNumber, annotation) { abstractFunction('editAnnotation'); }\n  get editAnnotation() { return this.__editAnnotation; }\n  set editAnnotation(fn) {\n    this.__editAnnotation = function editAnnotation(documentId, annotationId, annotation) {\n      return fn(...arguments).then((annotation) => {\n        fireEvent('annotation:edit', documentId, annotationId, annotation);\n        return annotation;\n      });\n    };\n  }\n\n  /**\n   * Delete an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise} Promise that returns with boolean if annotation was deleted\n   */\n  __deleteAnnotation(documentId, annotationId) { abstractFunction('deleteAnnotation'); }\n  get deleteAnnotation() { return this.__deleteAnnotation; }\n  set deleteAnnotation(fn) {\n    this.__deleteAnnotation = function deleteAnnotation(documentId, annotationId) {\n      return fn(...arguments).then((success) => {\n        if (success) {\n          fireEvent('annotation:delete', documentId, annotationId);\n        }\n        return success;\n      });\n    };\n  }\n\n  /**\n   * Get all the comments for an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise} Promise that returns with comments for annotation\n   */\n  getComments(documentId, annotationId) { abstractFunction('getComments'); }\n\n  /**\n   * Add a new comment\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @param {Object} content The definition of the comment\n   * @return {Promise} Promise that returns with the added comment\n   */\n  __addComment(documentId, annotationId, content) { abstractFunction('addComment'); }\n  get addComment() { return this.__addComment; }\n  set addComment(fn) {\n    this.__addComment = function addComment(documentId, annotationId, content) {\n      return fn(...arguments).then((comment) => {\n        fireEvent('comment:add', documentId, annotationId, comment);\n        return comment;\n      });\n    };\n  }\n\n  /**\n   * Delete a comment\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} commentId The ID for the comment\n   * @return {Promise} Promise that returns with boolean if comment was deleted\n   */\n  __deleteComment(documentId, commentId) { abstractFunction('deleteComment'); }\n  get deleteComment() { return this.__deleteComment; }\n  set deleteComment(fn) {\n    this.__deleteComment = function deleteComment(documentId, commentId) {\n      return fn(...arguments).then((success) => {\n        if (success) {\n          fireEvent('comment:delete', documentId, commentId);\n        }\n        return success;\n      });\n    };\n  }\n}\n","const REGEXP = /[xy]/g;\nconst PATTERN = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\n\nfunction replacement(c) {\n  let r = Math.random() * 16 | 0;\n  let v = c === 'x' ? r : (r & 0x3 | 0x8);\n  return v.toString(16);\n}\n\n/**\n * Generate a univierally unique identifier\n *\n * @return {String} A UUID\n */\nexport default function uuid() {\n  return PATTERN.replace(REGEXP, replacement);\n}\n","import uuid from '../utils/uuid';\nimport StoreAdapter from './StoreAdapter';\n\n// StoreAdapter for working with localStorage\n// This is ideal for testing, examples, and prototyping\nexport default class LocalStoreAdapter extends StoreAdapter {\n  constructor() {\n    super({\n      getAnnotations(documentId, pageNumber) {\n        return new Promise((resolve, reject) => {\n          let annotations = getAnnotations(documentId).filter((i) => {\n            return i.page === pageNumber && i.class === 'Annotation';\n          });\n\n          resolve({\n            documentId,\n            pageNumber,\n            annotations\n          });\n        });\n      }\n    });\n\n    this.getAnnotation = (documentId, annotationId) => {\n      return Promise.resolve(getAnnotations(documentId)[findAnnotation(documentId, annotationId)]);\n    };\n\n    this.addAnnotation = (documentId, pageNumber, annotation) => {\n      return new Promise((resolve, reject) => {\n        annotation.class = 'Annotation';\n        annotation.uuid = uuid();\n        annotation.page = pageNumber;\n\n        let annotations = getAnnotations(documentId);\n        annotations.push(annotation);\n        updateAnnotations(documentId, annotations);\n\n        resolve(annotation);\n      });\n    };\n\n    this.editAnnotation = (documentId, annotationId, annotation) => {\n      return new Promise((resolve, reject) => {\n        let annotations = getAnnotations(documentId);\n        annotations[findAnnotation(documentId, annotationId)] = annotation;\n        updateAnnotations(documentId, annotations);\n        resolve(annotation);\n      });\n    };\n\n    this.deleteAnnotation = (documentId, annotationId) => {\n      return new Promise((resolve, reject) => {\n        let annotation = getAnnotations(documentId).filter(i => i.uuid === annotationId)[0] || {};\n        if (!annotation) {\n          return reject('Could not find annotation');\n        }\n        let index = findAnnotation(documentId, annotationId);\n        if (index > -1) {\n          let annotations = getAnnotations(documentId);\n          annotations.splice(index, 1);\n          updateAnnotations(documentId, annotations);\n        }\n\n        resolve(true);\n      });\n    };\n\n    this.getComments = (documentId, annotationId) => {\n      return new Promise((resolve, reject) => {\n        resolve(getAnnotations(documentId).filter((i) => {\n          return i.class === 'Comment' && i.annotation === annotationId;\n        }));\n      });\n    };\n\n    this.addComment = (documentId, annotationId, content) => {\n      return new Promise((resolve, reject) => {\n        let comment = {\n          class: 'Comment',\n          uuid: uuid(),\n          annotation: annotationId,\n          content: content\n        };\n\n        let annotations = getAnnotations(documentId);\n        annotations.push(comment);\n        updateAnnotations(documentId, annotations);\n\n        resolve(comment);\n      });\n    };\n\n    this.deleteComment = (documentId, commentId) => {\n      return new Promise((resolve, reject) => {\n        let comment = getAnnotations(documentId).filter(i => i.uuid === commentId)[0] || {};\n        if (!comment) {\n          return reject('Could not find annotation');\n        }\n        let index = -1;\n        let annotations = getAnnotations(documentId);\n        for (let i = 0, l = annotations.length; i < l; i++) {\n          if (annotations[i].uuid === commentId) {\n            index = i;\n            break;\n          }\n        }\n\n        if (index > -1) {\n          annotations.splice(index, 1);\n          updateAnnotations(documentId, annotations);\n        }\n\n        resolve(true);\n      });\n    };\n  }\n}\n\nfunction getAnnotations(documentId) {\n  return JSON.parse(localStorage.getItem(`${documentId}/annotations`)) || [];\n}\n\nfunction updateAnnotations(documentId, annotations) {\n  localStorage.setItem(`${documentId}/annotations`, JSON.stringify(annotations));\n}\n/**\n *\n * @param {String} documentId Document id of the annotation\n * @param {String} annotationId The id of the annotation\n *\n * This function finds all the annotation made by one user.\n *\n * @return {int} The index of the annotation in localstorage\n */\nfunction findAnnotation(documentId, annotationId) {\n  let index = -1;\n  let annotations = getAnnotations(documentId);\n  for (let i = 0, l = annotations.length; i < l; i++) {\n    if (annotations[i].uuid === annotationId) {\n      index = i;\n      break;\n    }\n  }\n  return index;\n}\n","import uuid from '../utils/uuid';\nimport StoreAdapter from './StoreAdapter';\n\n// StoreAdapter for working with localStorage and associated user id\n// This is ideal for testing, examples, and prototyping\nexport default class LocalUserStoreAdapter extends StoreAdapter {\n  constructor(userId = 'user', globalEdit = false) {\n    super({\n      getAnnotations(documentId, pageNumber) {\n        return new Promise((resolve, reject) => {\n          let annotations = getAllAnnotations(documentId).filter((i) => {\n            return i.page === pageNumber && i.class === 'Annotation';\n          });\n\n          resolve({\n            documentId,\n            pageNumber,\n            annotations\n          });\n        });\n      }\n    });\n\n    this._userId = userId;\n    this._globalEdit = globalEdit;\n\n    this.getAnnotation = (documentId, annotationId) => {\n      return Promise.resolve(getAnnotations(documentId, this._userId)[findAnnotation(documentId, this._userId, annotationId)]);\n    };\n\n    this.addAnnotation = (documentId, pageNumber, annotation) => {\n      return new Promise((resolve, reject) => {\n        annotation.class = 'Annotation';\n        annotation.uuid = uuid();\n        annotation.page = pageNumber;\n        annotation.userId = this._userId;\n\n        let annotations = getAnnotations(documentId, this._userId);\n        annotations.push(annotation);\n        updateAnnotations(documentId, this._userId, annotations);\n\n        resolve(annotation);\n      });\n    };\n\n    this.editAnnotation = (documentId, annotationId, annotation) => {\n      return new Promise((resolve, reject) => {\n        if (!this._globalEdit && annotation.userId && annotation.userId !== this._userId) {\n          reject('Non-matching userId');\n        }\n        let annotations = getAnnotations(documentId, annotation.userId);\n        annotations[findAnnotation(documentId, annotation.userId, annotationId)] = annotation;\n        updateAnnotations(documentId, annotation.userId, annotations);\n        resolve(annotation);\n      });\n    };\n\n    this.deleteAnnotation = (documentId, annotationId) => {\n      return new Promise((resolve, reject) => {\n        let annotation = getAllAnnotations(documentId).filter(i => i.uuid === annotationId)[0] || {};\n        if (!annotation) {\n          return reject('Could not find annotation');\n        }\n        else if (!this._globalEdit && annotation.userId && annotation.userId !== this._userId) {\n          return reject('Non-matching userId');\n        }\n        let index = findAnnotation(documentId, annotation.userId, annotationId);\n        if (index > -1) {\n          let annotations = getAnnotations(documentId, annotation.userId);\n          annotations.splice(index, 1);\n          updateAnnotations(documentId, annotation.userId, annotations);\n        }\n\n        resolve(true);\n      });\n    };\n\n    this.getComments = (documentId, annotationId) => {\n      return new Promise((resolve, reject) => {\n        resolve(getAnnotations(documentId, this._userId).filter((i) => {\n          return i.class === 'Comment' && i.annotation === annotationId;\n        }));\n      });\n    };\n\n    this.addComment = (documentId, annotationId, content) => {\n      return new Promise((resolve, reject) => {\n        let comment = {\n          class: 'Comment',\n          uuid: uuid(),\n          annotation: annotationId,\n          content: content,\n          userId: this._userId\n        };\n\n        let annotations = getAnnotations(documentId, this._userId);\n        annotations.push(comment);\n        updateAnnotations(documentId, this._userId, annotations);\n\n        resolve(comment);\n      });\n    };\n\n    this.deleteComment = (documentId, commentId) => {\n      return new Promise((resolve, reject) => {\n        let comment = getAllAnnotations(documentId).filter(i => i.uuid === commentId)[0] || {};\n        if (!comment) {\n          return reject('Could not find annotation');\n        }\n        else if (!this._globalEdit && comment.userId && comment.userId !== this._userId) {\n          return reject('Non-matching userId');\n        }\n        let index = -1;\n        let annotations = getAnnotations(documentId, comment.userId);\n        for (let i = 0, l = annotations.length; i < l; i++) {\n          if (annotations[i].uuid === commentId) {\n            index = i;\n            break;\n          }\n        }\n\n        if (index > -1) {\n          annotations.splice(index, 1);\n          updateAnnotations(documentId, comment.userId, annotations);\n        }\n\n        resolve(true);\n      });\n    };\n  }\n\n  get userId() {\n    return this._userId;\n  }\n}\n\nfunction getAllAnnotations(documentId) {\n  let all_annotations = [];\n  let re = new RegExp(`${documentId}/(.*)/annotations`);\n  for (let i = 0; i < localStorage.length; i++) {\n    if (localStorage.key(i).search(re) > -1) {\n      all_annotations.push(...JSON.parse(localStorage.getItem(localStorage.key(i))));\n    }\n  }\n  return all_annotations;\n}\n\nfunction getAnnotations(documentId, userId) {\n  return JSON.parse(localStorage.getItem(`${documentId}/${userId}/annotations`)) || [];\n}\n\nfunction updateAnnotations(documentId, userId, annotations) {\n  localStorage.setItem(`${documentId}/${userId}/annotations`, JSON.stringify(annotations));\n}\n/**\n *\n * @param {String} documentId Document id of the annotation\n * @param {String} userId User id of the annotation\n * @param {String} annotationId The id of the annotation\n *\n * This function finds all the annotation made by one user.\n *\n * @return {int} The index of the annotation in localstorage\n */\nfunction findAnnotation(documentId, userId, annotationId) {\n  let index = -1;\n  let annotations = getAnnotations(documentId, userId);\n  for (let i = 0, l = annotations.length; i < l; i++) {\n    if (annotations[i].uuid === annotationId) {\n      index = i;\n      break;\n    }\n  }\n  return index;\n}\n","export default {\n  annotationLayerName: 'annotationLayer',\n  textLayerName: 'textLayer',\n  annotationSvgQuery: function() {\n    return 'svg.' + this.annotationLayerName;\n  },\n  annotationClassQuery: function() {\n    return '.' + this.annotationLayerName;\n  },\n  textClassQuery: function() {\n    return '.' + this.textLayerName;\n  }\n};\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport config from '../config';\nimport {\n  addEventListener,\n  removeEventListener\n} from './event';\nimport {\n  BORDER_COLOR,\n  disableUserSelect,\n  enableUserSelect,\n  findSVGContainer,\n  findSVGAtPoint,\n  getOffsetAnnotationRect,\n  getMetadata,\n  convertToSvgPoint\n} from './utils';\n\nlet _enabled = false;\nlet isDragging = false;\nlet overlay;\nlet dragOffsetX, dragOffsetY, dragStartX, dragStartY;\nconst OVERLAY_BORDER_SIZE = 3;\n\n/**\n * Create an overlay for editing an annotation.\n *\n * @param {Element} target The annotation element to apply overlay for\n */\nfunction createEditOverlay(target) {\n  destroyEditOverlay();\n\n  overlay = document.createElement('div');\n  let anchor = document.createElement('a');\n  let parentNode = findSVGContainer(target).parentNode;\n  let id = target.getAttribute('data-pdf-annotate-id');\n  let rect = getOffsetAnnotationRect(target);\n  let styleLeft = rect.left - OVERLAY_BORDER_SIZE;\n  let styleTop = rect.top - OVERLAY_BORDER_SIZE;\n\n  overlay.setAttribute('id', 'pdf-annotate-edit-overlay');\n  overlay.setAttribute('data-target-id', id);\n  overlay.style.boxSizing = 'content-box';\n  overlay.style.position = 'absolute';\n  overlay.style.top = `${styleTop}px`;\n  overlay.style.left = `${styleLeft}px`;\n  overlay.style.width = `${rect.width}px`;\n  overlay.style.height = `${rect.height}px`;\n  overlay.style.border = `${OVERLAY_BORDER_SIZE}px solid ${BORDER_COLOR}`;\n  overlay.style.borderRadius = `${OVERLAY_BORDER_SIZE}px`;\n  overlay.style.zIndex = 20100;\n\n  anchor.innerHTML = '';\n  anchor.setAttribute('href', 'javascript://');\n  anchor.style.background = '#fff';\n  anchor.style.borderRadius = '20px';\n  anchor.style.border = '1px solid #bbb';\n  anchor.style.color = '#bbb';\n  anchor.style.fontSize = '16px';\n  anchor.style.padding = '2px';\n  anchor.style.textAlign = 'center';\n  anchor.style.textDecoration = 'none';\n  anchor.style.position = 'absolute';\n  anchor.style.top = '-13px';\n  anchor.style.right = '-13px';\n  anchor.style.width = '25px';\n  anchor.style.height = '25px';\n\n  overlay.appendChild(anchor);\n  parentNode.appendChild(overlay);\n  document.addEventListener('click', handleDocumentClick);\n  document.addEventListener('keyup', handleDocumentKeyup);\n  document.addEventListener('mousedown', handleDocumentMousedown);\n  anchor.addEventListener('click', deleteAnnotation);\n  anchor.addEventListener('mouseover', () => {\n    anchor.style.color = '#35A4DC';\n    anchor.style.borderColor = '#999';\n    anchor.style.boxShadow = '0 1px 1px #ccc';\n  });\n  anchor.addEventListener('mouseout', () => {\n    anchor.style.color = '#bbb';\n    anchor.style.borderColor = '#bbb';\n    anchor.style.boxShadow = '';\n  });\n  overlay.addEventListener('mouseover', () => {\n    if (!isDragging) { anchor.style.display = ''; }\n  });\n  overlay.addEventListener('mouseout', () => {\n    anchor.style.display = 'none';\n  });\n}\n\n/**\n * Destroy the edit overlay if it exists.\n */\nfunction destroyEditOverlay() {\n  if (overlay) {\n    overlay.parentNode.removeChild(overlay);\n    overlay = null;\n  }\n\n  document.removeEventListener('click', handleDocumentClick);\n  document.removeEventListener('keyup', handleDocumentKeyup);\n  document.removeEventListener('mousedown', handleDocumentMousedown);\n  document.removeEventListener('mousemove', handleDocumentMousemove);\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n  enableUserSelect();\n}\n\n/**\n * Delete currently selected annotation\n */\nfunction deleteAnnotation() {\n  if (!overlay) {\n    return;\n  }\n\n  let annotationId = overlay.getAttribute('data-target-id');\n  let svg = overlay.parentNode.querySelector(config.annotationSvgQuery());\n  let { documentId } = getMetadata(svg);\n\n  PDFJSAnnotate.getStoreAdapter().deleteAnnotation(documentId, annotationId).then(() => {\n    let nodes = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n\n    [...nodes].forEach((n) => {\n      n.parentNode.removeChild(n);\n    });\n  });\n\n  destroyEditOverlay();\n}\n\n/**\n * Handle document.click event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentClick(e) {\n  if (!findSVGAtPoint(e.clientX, e.clientY)) { return; }\n\n  // Remove current overlay\n  let overlay = document.getElementById('pdf-annotate-edit-overlay');\n  if (overlay) {\n    if (isDragging || e.target === overlay) {\n      return;\n    }\n\n    destroyEditOverlay();\n  }\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {KeyboardEvent} e The DOM event that needs to be handled\n */\nfunction handleDocumentKeyup(e) {\n  // keyCode is deprecated, so prefer the newer \"key\" method if possible\n  let keyTest;\n  if (e.key) {\n    keyTest = e.key.toLowerCase() === 'delete' || e.key.toLowerCase() === 'backspace';\n  }\n  else {\n    keyTest = e.keyCode === 8 || e.keyCode === 46;\n  }\n  if (overlay && keyTest &&\n      e.target.nodeName.toLowerCase() !== 'textarea' &&\n      e.target.nodeName.toLowerCase() !== 'input') {\n    e.preventDefault();\n    deleteAnnotation();\n  }\n}\n\n/**\n * Handle document.mousedown event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMousedown(e) {\n  if (e.target !== overlay) {\n    return;\n  }\n\n  // Highlight and strikeout annotations are bound to text within the document.\n  // It doesn't make sense to allow repositioning these types of annotations.\n  let annotationId = overlay.getAttribute('data-target-id');\n  let target = document.querySelector(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n  let type = target.getAttribute('data-pdf-annotate-type');\n\n  if (type === 'highlight' || type === 'strikeout') { return; }\n\n  isDragging = true;\n  dragOffsetX = e.clientX;\n  dragOffsetY = e.clientY;\n  dragStartX = overlay.offsetLeft;\n  dragStartY = overlay.offsetTop;\n\n  overlay.style.background = 'rgba(255, 255, 255, 0.7)';\n  overlay.style.cursor = 'move';\n  overlay.querySelector('a').style.display = 'none';\n\n  document.addEventListener('mousemove', handleDocumentMousemove);\n  document.addEventListener('mouseup', handleDocumentMouseup);\n  disableUserSelect();\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMousemove(e) {\n  let parentNode = overlay.parentNode;\n  let rect = parentNode.getBoundingClientRect();\n  let y = (dragStartY + (e.clientY - dragOffsetY));\n  let x = (dragStartX + (e.clientX - dragOffsetX));\n  let minY = 0;\n  let maxY = rect.height;\n  let minX = 0;\n  let maxX = rect.width;\n\n  if (y > minY && y + overlay.offsetHeight < maxY) {\n    overlay.style.top = `${y}px`;\n  }\n\n  if (x > minX && x + overlay.offsetWidth < maxX) {\n    overlay.style.left = `${x}px`;\n  }\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMouseup(e) {\n  let annotationId = overlay.getAttribute('data-target-id');\n  let target = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n  let type = target[0].getAttribute('data-pdf-annotate-type');\n  let svg = overlay.parentNode.querySelector(config.annotationSvgQuery());\n  let { documentId } = getMetadata(svg);\n\n  overlay.querySelector('a').style.display = '';\n\n  PDFJSAnnotate.getStoreAdapter().getAnnotation(documentId, annotationId).then((annotation) => {\n    let attribX = 'x';\n    let attribY = 'y';\n    if (['circle', 'fillcircle', 'emptycircle'].indexOf(type) > -1) {\n      attribX = 'cx';\n      attribY = 'cy';\n    }\n\n    if (type === 'point') {\n      // Broken\n      /*\n      [...target].forEach((t, i) => {\n        let moveTo = {\n          x: overlay.offsetLeft + 3,\n          y: overlay.offsetTop + 3\n        };\n        t.setAttribute(attribX, moveTo.x);\n        t.setAttribute(attribY, moveTo.y);\n        annotation[attribX] = moveTo.x;\n        annotation[attribY] = moveTo.y;\n      });\n      */\n      return;\n    }\n    else if (['area', 'highlight', 'textbox', 'circle', 'fillcircle', 'emptycircle'].indexOf(type) > -1) {\n      let modelStart = convertToSvgPoint([dragStartX, dragStartY], svg);\n      let modelEnd = convertToSvgPoint([overlay.offsetLeft, overlay.offsetTop], svg);\n      let modelDelta = {\n        x: modelEnd[0] - modelStart[0],\n        y: modelEnd[1] - modelStart[1]\n      };\n\n      if (type === 'textbox') {\n        target = [target[0].firstChild];\n      }\n\n      [...target].forEach((t, i) => {\n        let modelX = parseInt(t.getAttribute(attribX), 10);\n        let modelY = parseInt(t.getAttribute(attribY), 10);\n        if (modelDelta.y !== 0) {\n          modelY = modelY + modelDelta.y;\n\n          t.setAttribute(attribY, modelY);\n          if (annotation.rectangles && i < annotation.rectangles.length) {\n            annotation.rectangles[i].y = modelY;\n          }\n          else if (annotation[attribY]) {\n            annotation[attribY] = modelY;\n          }\n        }\n        if (modelDelta.x !== 0) {\n          modelX = modelX + modelDelta.x;\n\n          t.setAttribute(attribX, modelX);\n          if (annotation.rectangles && i < annotation.rectangles.length) {\n            annotation.rectangles[i].x = modelX;\n          }\n          else if (annotation[attribX]) {\n            annotation[attribX] = modelX;\n          }\n        }\n      });\n    }\n    else if (type === 'strikeout') {\n      return;\n    //   let { deltaX, deltaY } = getDelta('x1', 'y1');\n    //   [...target].forEach(target, (t, i) => {\n    //     if (deltaY !== 0) {\n    //       t.setAttribute('y1', parseInt(t.getAttribute('y1'), 10) + deltaY);\n    //       t.setAttribute('y2', parseInt(t.getAttribute('y2'), 10) + deltaY);\n    //       annotation.rectangles[i].y = parseInt(t.getAttribute('y1'), 10);\n    //     }\n    //     if (deltaX !== 0) {\n    //       t.setAttribute('x1', parseInt(t.getAttribute('x1'), 10) + deltaX);\n    //       t.setAttribute('x2', parseInt(t.getAttribute('x2'), 10) + deltaX);\n    //       annotation.rectangles[i].x = parseInt(t.getAttribute('x1'), 10);\n    //     }\n    //   });\n    }\n    else if (type === 'drawing' || type === 'arrow') {\n      // Do nothing as currently broken\n      /*\n      let modelStart = convertToSvgPoint([dragStartX, dragStartY], svg);\n      let modelEnd = convertToSvgPoint([overlay.offsetLeft, overlay.offsetTop], svg);\n      let modelDelta = {\n        x: modelEnd[0] - modelStart[0],\n        y: modelEnd[1] - modelStart[1]\n      };\n\n      annotation.lines.forEach((line, i) => {\n        let [x, y] = annotation.lines[i];\n        annotation.lines[i][0] = x + modelDelta.x;\n        annotation.lines[i][1] = y + modelDelta.y;\n      });\n\n      target[0].parentNode.removeChild(target[0]);\n      appendChild(svg, annotation);\n      */\n      return;\n    }\n\n    PDFJSAnnotate.getStoreAdapter().editAnnotation(documentId, annotationId, annotation);\n  });\n\n  setTimeout(() => {\n    isDragging = false;\n  }, 0);\n\n  overlay.style.background = '';\n  overlay.style.cursor = '';\n\n  document.removeEventListener('mousemove', handleDocumentMousemove);\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n  enableUserSelect();\n}\n\n/**\n * Handle annotation.click event\n *\n * @param {Element} e The annotation element that was clicked\n */\nfunction handleAnnotationClick(target) {\n  createEditOverlay(target);\n}\n\n/**\n * Enable edit mode behavior.\n */\nexport function enableEdit() {\n  if (_enabled) {\n    return;\n  }\n\n  _enabled = true;\n  addEventListener('annotation:click', handleAnnotationClick);\n};\n\n/**\n * Disable edit mode behavior.\n */\nexport function disableEdit() {\n  destroyEditOverlay();\n\n  if (!_enabled) {\n    return;\n  }\n\n  _enabled = false;\n  removeEventListener('annotation:click', handleAnnotationClick);\n};\n\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport { appendChild } from '../render/appendChild';\nimport {\n  disableUserSelect,\n  enableUserSelect,\n  findSVGAtPoint,\n  getMetadata,\n  convertToSvgPoint\n} from './utils';\n\nlet _enabled = false;\nlet _candraw = false;\nlet _penSize;\nlet _penColor;\nlet path;\nlet lines = [];\n\n/**\n * Handle document.touchdown or document.pointerdown event\n * @param {PointerEvent} e The DOM event to be handled\n */\nfunction handleDocumentPointerdown(e) {\n  path = null;\n  lines = [];\n  if (!findSVGAtPoint(e.clientX, e.clientY)) {\n    return;\n  }\n  _candraw = true;\n  e.preventDefault();\n}\n\n/**\n * Handle document.pointerup event\n *\n * @param {PointerEvent} e The DOM event to be handled\n */\nfunction handleDocumentPointerup(e) {\n  saveToStorage(e.clientX, e.clientY);\n}\n\nfunction saveToStorage(x, y) {\n  if (!_candraw) {\n    return;\n  }\n  _candraw = false;\n  let svg;\n  if (lines.length > 1 && (svg = findSVGAtPoint(x, y))) {\n    let { documentId, pageNumber } = getMetadata(svg);\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, {\n      type: 'drawing',\n      width: _penSize,\n      color: _penColor,\n      lines\n    }).then((annotation) => {\n      if (path) {\n        svg.removeChild(path);\n      }\n\n      appendChild(svg, annotation);\n    });\n  }\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {PointerEvent} e The DOM event to be handled\n */\nfunction handleDocumentPointermove(e) {\n  if (!findSVGAtPoint(e.clientX, e.clientY) || !_candraw) {\n    return;\n  }\n  savePoint(e.clientX, e.clientY);\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {KeyboardEvent} e The DOM event to be handled\n * } e The DOM event to be handled\n */\nfunction handleDocumentKeyup(e) {\n  // Cancel rect if Esc is pressed\n  if (e.keyCode === 27) {\n    lines = null;\n    path.parentNode.removeChild(path);\n    document.removeEventListener('pointermove', handleDocumentPointermove);\n    document.removeEventListener('pointerup', handleDocumentPointerup);\n  }\n}\n\n/**\n * Save a point to the line being drawn.\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n */\nfunction savePoint(x, y) {\n  let svg = findSVGAtPoint(x, y);\n  if (!svg) {\n    return;\n  }\n\n  let rect = svg.getBoundingClientRect();\n  let point = convertToSvgPoint([\n    x - rect.left,\n    y - rect.top\n  ], svg);\n  point[0] = point[0].toFixed(2);\n  point[1] = point[1].toFixed(2);\n  lines.push(point);\n\n  if (lines.length <= 1) {\n    return;\n  }\n\n  if (path) {\n    svg.removeChild(path);\n  }\n\n  path = appendChild(svg, {\n    type: 'drawing',\n    color: _penColor,\n    width: _penSize,\n    lines\n  });\n}\n\n/**\n * Set the attributes of the pen.\n *\n * @param {Number} penSize The size of the lines drawn by the pen, rounded to 2 decimal places\n * @param {String} penColor The color of the lines drawn by the pen\n */\nexport function setPen(penSize = 1, penColor = '000000') {\n  _penSize = Math.round(parseFloat(penSize) * 1e2) / 1e2;\n  _penColor = penColor;\n}\n\n/**\n * Return pen attributes of the pen\n *\n * @return {Object} Object with size and color\n */\nexport function getPen() {\n  return {\n    size: _penSize,\n    color: _penColor\n  };\n}\n\n/**\n * Enable the pen behavior\n */\nexport function enablePen() {\n  if (_enabled) {\n    return;\n  }\n\n  _enabled = true;\n  // Chrome and Firefox has different behaviors with how pen works, so we need different events.\n  document.addEventListener('pointerdown', handleDocumentPointerdown);\n  document.addEventListener('pointermove', handleDocumentPointermove);\n  document.addEventListener('pointerup', handleDocumentPointerup);\n\n  document.addEventListener('keyup', handleDocumentKeyup);\n  disableUserSelect();\n}\n\n/**\n * Disable the pen behavior\n */\nexport function disablePen() {\n  if (!_enabled) {\n    return;\n  }\n\n  _enabled = false;\n  document.removeEventListener('pointerdown', handleDocumentPointerdown);\n  document.removeEventListener('pointermove', handleDocumentPointermove);\n  document.removeEventListener('pointerup', handleDocumentPointerup);\n\n  document.removeEventListener('keyup', handleDocumentKeyup);\n  enableUserSelect();\n}\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport { appendChild } from '../render/appendChild';\nimport {\n  disableUserSelect,\n  enableUserSelect,\n  findSVGAtPoint,\n  findSVGContainer,\n  getMetadata,\n  convertToSvgPoint,\n  convertToScreenPoint,\n  findAnnotationAtPoint\n} from './utils';\n\nlet _enabled = false;\nlet _penSize;\nlet _penColor;\nlet path;\nlet lines;\nlet originY;\nlet originX;\n\n/**\n * Handle document.mousedown event\n */\nfunction handleDocumentMousedown(e) {\n  let target = findAnnotationAtPoint(e.clientX, e.clientY);\n  if (target === null) {\n    return;\n  }\n\n  let type = target.getAttribute('data-pdf-annotate-type');\n  if (type !== 'circle' && type !== 'fillcircle' && type !== 'emptycircle') {\n    return;\n  }\n\n  let svg = findSVGContainer(target);\n  let { documentId } = getMetadata(svg);\n  let annotationId = target.getAttribute('data-pdf-annotate-id');\n\n  PDFJSAnnotate.getStoreAdapter().getAnnotation(documentId, annotationId).then((annotation) => {\n    if (annotation) {\n      path = null;\n      lines = [];\n\n      let point = convertToScreenPoint([\n        annotation.cx,\n        annotation.cy\n      ], svg);\n\n      let rect = svg.getBoundingClientRect();\n\n      originX = point[0] + rect.left;\n      originY = point[1] + rect.top;\n\n      document.addEventListener('mousemove', handleDocumentMousemove);\n      document.addEventListener('mouseup', handleDocumentMouseup);\n    }\n  });\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentMouseup(e) {\n  let svg;\n  if (lines.length > 1 && (svg = findSVGAtPoint(e.clientX, e.clientY))) {\n    let { documentId, pageNumber } = getMetadata(svg);\n\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, {\n      type: 'arrow',\n      width: _penSize,\n      color: _penColor,\n      lines\n    }).then((annotation) => {\n      if (path) {\n        svg.removeChild(path);\n      }\n\n      appendChild(svg, annotation);\n    });\n  }\n\n  document.removeEventListener('mousemove', handleDocumentMousemove);\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentMousemove(e) {\n  let x = lines.length === 0 ? originX : e.clientX;\n  let y = lines.length === 0 ? originY : e.clientY;\n\n  savePoint(x, y);\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentKeyup(e) {\n  // Cancel rect if Esc is pressed\n  if (e.keyCode === 27) {\n    lines = null;\n    path.parentNode.removeChild(path);\n    document.removeEventListener('mousemove', handleDocumentMousemove);\n    document.removeEventListener('mouseup', handleDocumentMouseup);\n  }\n}\n\n/**\n * Save a point to the line being drawn.\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n */\nfunction savePoint(x, y) {\n  let svg = findSVGAtPoint(x, y);\n  if (!svg) {\n    return;\n  }\n\n  let rect = svg.getBoundingClientRect();\n  let point = convertToSvgPoint([\n    x - rect.left,\n    y - rect.top\n  ], svg);\n\n  if (lines.length < 2) {\n    lines.push(point);\n    return;\n  }\n  else {\n    lines[1] = point; // update end point\n  }\n\n  if (path) {\n    svg.removeChild(path);\n  }\n\n  path = appendChild(svg, {\n    type: 'arrow',\n    color: _penColor,\n    width: _penSize,\n    lines\n  });\n}\n\n/**\n * Set the attributes of the pen.\n *\n * @param {Number} penSize The size of the lines drawn by the pen\n * @param {String} penColor The color of the lines drawn by the pen\n */\nexport function setArrow(penSize = 10, penColor = '0000FF') {\n  _penSize = parseInt(penSize, 10);\n  _penColor = penColor;\n}\n\n/**\n * Enable the pen behavior\n */\nexport function enableArrow() {\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mousedown', handleDocumentMousedown);\n  document.addEventListener('keyup', handleDocumentKeyup);\n  disableUserSelect();\n}\n\n/**\n * Disable the pen behavior\n */\nexport function disableArrow() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mousedown', handleDocumentMousedown);\n  document.removeEventListener('keyup', handleDocumentKeyup);\n  enableUserSelect();\n}\n\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport {\n  findAnnotationAtPoint,\n  getMetadata\n} from './utils';\n\nlet _canerase = false;\nlet previousPoint = null;\n\n/**\n *\n * @param {PointerEvent} e DOM event to handle\n */\nfunction handleDocumentDown(e) {\n  _canerase = true;\n  previousPoint = [e.clientX, e.clientY];\n}\n\n/**\n *\n * @param {PointerEvent} e DOM event to handle\n */\nfunction handleDocumentUp(e) {\n  _canerase = false;\n  erase(findAnnotationAtPoint(e.clientX, e.clientY));\n}\n\n/**\n *\n * @param {PointerEvent} e DOM event to handle\n */\nfunction handleDocumentMouseMove(e) {\n  if (!_canerase) {\n    return;\n  }\n\n  // This algorithm attempts to get the various points between the last\n  // PointerEvent and this one\n  let check = [];\n  let diffX = Math.abs(previousPoint[0] - e.clientX);\n  let diffY = Math.abs(previousPoint[1] - e.clientY);\n  if (diffX >= 1 || diffY >= 1) {\n    let maxSteps = Math.round(Math.max(diffX, diffY));\n    let subStepSize = Math.min(diffX, diffY) / maxSteps;\n    let smallerTest = diffX < diffY;\n    let startPoint = [\n      Math.min(previousPoint[0], e.clientX),\n      Math.min(previousPoint[1], e.clientY)\n    ];\n    for (let i = 0; i < maxSteps; i++) {\n      if (smallerTest) {\n        check.push([Math.round(startPoint[0] + (subStepSize * i)), Math.round(startPoint[1] + i)]);\n      }\n      else {\n        check.push([Math.round(startPoint[0] + i), Math.round(startPoint[1] + (subStepSize * i))]);\n      }\n    }\n  }\n  for (let point of check) {\n    erase(findAnnotationAtPoint(point[0], point[1]));\n  }\n  previousPoint = [e.clientX, e.clientY];\n}\n\nfunction erase(target) {\n  if (!_canerase) {\n    return;\n  }\n\n  if (target) {\n    let { documentId } = getMetadata(target.parentElement);\n    let annotationId = target.getAttribute('data-pdf-annotate-id');\n    PDFJSAnnotate.getStoreAdapter().deleteAnnotation(documentId, annotationId).then(() => {\n      let nodes = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n      [...nodes].forEach((n) => {\n        n.parentNode.removeChild(n);\n      });\n    });\n  }\n}\n\nexport function enableEraser() {\n  document.addEventListener('pointermove', handleDocumentMouseMove);\n  document.addEventListener('pointerdown', handleDocumentDown);\n  document.addEventListener('pointerup', handleDocumentUp);\n}\n\nexport function disableEraser() {\n  document.removeEventListener('pointermove', handleDocumentMouseMove);\n  document.removeEventListener('pointerdown', handleDocumentDown);\n  document.removeEventListener('pointerup', handleDocumentUp);\n}\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport { appendChild } from '../render/appendChild';\nimport {\n  BORDER_COLOR,\n  findSVGAtPoint,\n  getMetadata,\n  scaleDown\n} from './utils';\n\nlet _enabled = false;\nlet input;\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} The DOM event to be handled\n */\nfunction handleDocumentMouseup(e) {\n  if (input || !findSVGAtPoint(e.clientX, e.clientY)) {\n    return;\n  }\n\n  input = document.createElement('input');\n  input.setAttribute('id', 'pdf-annotate-point-input');\n  input.setAttribute('placeholder', 'Enter comment');\n  input.style.border = `3px solid ${BORDER_COLOR}`;\n  input.style.borderRadius = '3px';\n  input.style.position = 'absolute';\n  input.style.top = `${e.clientY}px`;\n  input.style.left = `${e.clientX}px`;\n\n  input.addEventListener('blur', handleInputBlur);\n  input.addEventListener('keyup', handleInputKeyup);\n\n  document.body.appendChild(input);\n  input.focus();\n}\n\n/**\n * Handle input.blur event\n */\nfunction handleInputBlur() {\n  savePoint();\n}\n\n/**\n * Handle input.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleInputKeyup(e) {\n  if (e.keyCode === 27) {\n    closeInput();\n  }\n  else if (e.keyCode === 13) {\n    savePoint();\n  }\n}\n\n/**\n * Save a new point annotation from input\n */\nfunction savePoint() {\n  if (input.value.trim().length > 0) {\n    let clientX = parseInt(input.style.left, 10);\n    let clientY = parseInt(input.style.top, 10);\n    let content = input.value.trim();\n    let svg = findSVGAtPoint(clientX, clientY);\n    if (!svg) {\n      return;\n    }\n\n    let rect = svg.getBoundingClientRect();\n    let { documentId, pageNumber } = getMetadata(svg);\n    let annotation = Object.assign({\n      type: 'point'\n    }, scaleDown(svg, {\n      x: clientX - rect.left,\n      y: clientY - rect.top\n    }));\n\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n      .then((annotation) => {\n        PDFJSAnnotate.getStoreAdapter().addComment(\n          documentId,\n          annotation.uuid,\n          content\n        );\n\n        appendChild(svg, annotation);\n      });\n  }\n\n  closeInput();\n}\n\n/**\n * Close the input element\n */\nfunction closeInput() {\n  input.removeEventListener('blur', handleInputBlur);\n  input.removeEventListener('keyup', handleInputKeyup);\n  document.body.removeChild(input);\n  input = null;\n}\n\n/**\n * Enable point annotation behavior\n */\nexport function enablePoint() {\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Disable point annotation behavior\n */\nexport function disablePoint() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport config from '../config';\nimport { appendChild } from '../render/appendChild';\nimport {\n  BORDER_COLOR,\n  disableUserSelect,\n  enableUserSelect,\n  findSVGAtPoint,\n  getMetadata,\n  convertToSvgRect\n} from './utils';\n\nlet _enabled = false;\nlet _type;\nlet overlay;\nlet originY;\nlet originX;\n\n/**\n * Get the current window selection as rects\n *\n * @return {Array} An Array of rects\n */\nfunction getSelectionRects() {\n  try {\n    let selection = window.getSelection();\n    let range = selection.getRangeAt(0);\n    let rects = range.getClientRects();\n\n    if (rects.length > 0 &&\n        rects[0].width > 0 &&\n        rects[0].height > 0) {\n      return rects;\n    }\n  }\n  catch (e) {}\n\n  return null;\n}\n\n/**\n * Handle document.mousedown event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMousedown(e) {\n  let svg;\n  if (_type !== 'area' || !(svg = findSVGAtPoint(e.clientX, e.clientY))) {\n    return;\n  }\n\n  let rect = svg.getBoundingClientRect();\n  originY = e.clientY;\n  originX = e.clientX;\n\n  overlay = document.createElement('div');\n  overlay.style.position = 'absolute';\n  overlay.style.top = `${originY - rect.top}px`;\n  overlay.style.left = `${originX - rect.left}px`;\n  overlay.style.border = `3px solid ${BORDER_COLOR}`;\n  overlay.style.borderRadius = '3px';\n  svg.parentNode.appendChild(overlay);\n\n  document.addEventListener('mousemove', handleDocumentMousemove);\n  disableUserSelect();\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMousemove(e) {\n  let svg = overlay.parentNode.querySelector(config.annotationSvgQuery());\n  let rect = svg.getBoundingClientRect();\n\n  if (originX + (e.clientX - originX) < rect.right) {\n    overlay.style.width = `${e.clientX - originX}px`;\n  }\n\n  if (originY + (e.clientY - originY) < rect.bottom) {\n    overlay.style.height = `${e.clientY - originY}px`;\n  }\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n  let rects;\n  if (_type !== 'area' && (rects = getSelectionRects())) {\n    saveRect(_type, [...rects].map((r) => {\n      return {\n        top: r.top,\n        left: r.left,\n        width: r.width,\n        height: r.height\n      };\n    }));\n  }\n  else if (_type === 'area' && overlay) {\n    let svg = overlay.parentNode.querySelector(config.annotationSvgQuery());\n    let rect = svg.getBoundingClientRect();\n    saveRect(_type, [{\n      top: parseInt(overlay.style.top, 10) + rect.top,\n      left: parseInt(overlay.style.left, 10) + rect.left,\n      width: parseInt(overlay.style.width, 10),\n      height: parseInt(overlay.style.height, 10)\n    }]);\n\n    overlay.parentNode.removeChild(overlay);\n    overlay = null;\n\n    document.removeEventListener('mousemove', handleDocumentMousemove);\n    enableUserSelect();\n  }\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentKeyup(e) {\n  // Cancel rect if Esc is pressed\n  if (e.keyCode === 27) {\n    let selection = window.getSelection();\n    selection.removeAllRanges();\n    if (overlay && overlay.parentNode) {\n      overlay.parentNode.removeChild(overlay);\n      overlay = null;\n      document.removeEventListener('mousemove', handleDocumentMousemove);\n    }\n  }\n}\n\n/**\n * Save a rect annotation\n *\n * @param {String} type The type of rect (area, highlight, strikeout)\n * @param {Array} rects The rects to use for annotation\n * @param {String} color The color of the rects\n */\nfunction saveRect(type, rects, color) {\n  let svg = findSVGAtPoint(rects[0].left, rects[0].top);\n  let annotation;\n\n  if (!svg) {\n    return;\n  }\n\n  let boundingRect = svg.getBoundingClientRect();\n\n  if (!color) {\n    if (type === 'highlight') {\n      color = 'FFFF00';\n    }\n    else if (type === 'strikeout') {\n      color = 'FF0000';\n    }\n  }\n\n  // Initialize the annotation\n  annotation = {\n    type,\n    color,\n    rectangles: [...rects].map((r) => {\n      let offset = 0;\n\n      if (type === 'strikeout') {\n        offset = r.height / 2;\n      }\n\n      return convertToSvgRect({\n        y: (r.top + offset) - boundingRect.top,\n        x: r.left - boundingRect.left,\n        width: r.width,\n        height: r.height\n      }, svg);\n    }).filter((r) => r.width > 0 && r.height > 0 && r.x > -1 && r.y > -1)\n  };\n\n  // Short circuit if no rectangles exist\n  if (annotation.rectangles.length === 0) {\n    return;\n  }\n\n  // Special treatment for area as it only supports a single rect\n  if (type === 'area') {\n    let rect = annotation.rectangles[0];\n    delete annotation.rectangles;\n    annotation.x = rect.x;\n    annotation.y = rect.y;\n    annotation.width = rect.width;\n    annotation.height = rect.height;\n  }\n\n  let { documentId, pageNumber } = getMetadata(svg);\n\n  // Add the annotation\n  PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n    .then((annotation) => {\n      appendChild(svg, annotation);\n    });\n}\n\n/**\n * Enable rect behavior\n */\nexport function enableRect(type) {\n  _type = type;\n\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n  document.addEventListener('mousedown', handleDocumentMousedown);\n  document.addEventListener('keyup', handleDocumentKeyup);\n}\n\n/**\n * Disable rect behavior\n */\nexport function disableRect() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n  document.removeEventListener('mousedown', handleDocumentMousedown);\n  document.removeEventListener('keyup', handleDocumentKeyup);\n}\n\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport { appendChild } from '../render/appendChild';\nimport {\n  findSVGAtPoint,\n  getMetadata,\n  convertToSvgPoint\n} from './utils';\n\nlet _enabled = false;\nlet _type;\nlet _circleRadius = 10;\nlet _circleColor = '0000FF';\n\n/**\n * Set the attributes of the pen.\n *\n * @param {Number} circleRadius The radius of the circle\n * @param {String} circleColor The color of the circle\n */\nexport function setCircle(circleRadius = 10, circleColor = '0000FF') {\n  _circleRadius = parseInt(circleRadius, 10);\n  _circleColor = circleColor;\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n  let svg = findSVGAtPoint(e.clientX, e.clientY);\n  if (!svg) {\n    return;\n  }\n  let rect = svg.getBoundingClientRect();\n  saveCircle(svg, _type, {\n    x: e.clientX - rect.left,\n    y: e.clientY - rect.top\n  }, _circleRadius, _circleColor);\n}\n\n/**\n * Save a circle annotation\n *\n * @param {SVGElement} svg\n * @param {String} type The type of circle (circle, emptycircle, fillcircle)\n * @param {Object} pt The point to use for annotation\n * @param {float} radius\n * @param {String} color The color of the rects\n */\nfunction saveCircle(svg, type, pt, radius, color) {\n  // Initialize the annotation\n  let svg_pt = convertToSvgPoint([ pt.x, pt.y ], svg);\n  let annotation = {\n    type,\n    color,\n    cx: svg_pt[0],\n    cy: svg_pt[1],\n    r: radius\n  };\n\n  let { documentId, pageNumber } = getMetadata(svg);\n\n  // Add the annotation\n  PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n    .then((annotation) => {\n      appendChild(svg, annotation);\n    });\n}\n\n/**\n * Enable circle behavior\n */\nexport function enableCircle(type) {\n  _type = type;\n\n  if (_enabled) { return; }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Disable circle behavior\n */\nexport function disableCircle() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\nexport function addCircle(type, e) {\n  let oldType = _type;\n  _type = type;\n  handleDocumentMouseup(e);\n  _type = oldType;\n}\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport { appendChild } from '../render/appendChild';\nimport {\n  BORDER_COLOR,\n  findSVGAtPoint,\n  getMetadata,\n  convertToSvgPoint\n} from './utils';\n\nlet _enabled = false;\nlet input;\nlet _textSize = localStorage.getItem(`text/size`) || 12;\nlet _textColor = localStorage.getItem(`text/color`) || '#000000';\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n  if (input || !findSVGAtPoint(e.clientX, e.clientY)) {\n    return;\n  }\n  if (!e.srcElement.classList.contains('annotationLayer')) {\n    return;\n  }\n  input = document.createElement('textarea');\n  input.setAttribute('id', 'pdf-annotate-text-input');\n  input.setAttribute('placeholder', 'Enter text... SHIFT + ENTER for new line');\n  input.style.border = `3px solid ${BORDER_COLOR}`;\n  input.style.borderRadius = '3px';\n  input.style.position = 'fixed';\n  input.style.top = `${e.clientY}px`;\n  input.style.left = `${e.clientX}px`;\n  input.style.fontSize = `${_textSize}px`;\n  input.style.zIndex = '41';\n  input.addEventListener('blur', handleInputBlur);\n  input.addEventListener('keyup', handleInputKeyup);\n\n  document.body.appendChild(input);\n  input.focus();\n}\n\n/**\n * Handle input.blur event\n */\nfunction handleInputBlur() {\n  saveText();\n}\n\n/**\n * Handle input.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleInputKeyup(e) {\n  if (e.keyCode === 27) {\n    closeInput();\n  }\n  else if (e.keyCode === 13 && !e.shiftKey) {\n    saveText();\n  }\n}\n\n/**\n * Save a text annotation from input\n */\nfunction saveText() {\n  let value = (input.value) ? input.value.replace(/ +$/, '') : '';\n  if (value.length > 0) {\n    let clientX = parseInt(input.style.left, 10);\n    let clientY = parseInt(input.style.top, 10);\n    let svg = findSVGAtPoint(clientX, clientY);\n    if (!svg) {\n      return;\n    }\n    let height = _textSize;\n    let { documentId, pageNumber, viewport } = getMetadata(svg);\n    let scale = 1 / viewport.scale;\n    let rect = svg.getBoundingClientRect();\n    let pt = convertToSvgPoint([\n      clientX - rect.left,\n      clientY - rect.top + height], svg, viewport);\n    let annotation = {\n      type: 'textbox',\n      size: _textSize * scale,\n      color: _textColor,\n      content: value,\n      x: pt[0],\n      y: pt[1],\n      rotation: -viewport.rotation\n    };\n\n    PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n      .then((annotation) => {\n        appendChild(svg, annotation);\n      });\n  }\n\n  closeInput();\n}\n\n/**\n * Close the input\n */\nfunction closeInput() {\n  if (input) {\n    input.removeEventListener('blur', handleInputBlur);\n    input.removeEventListener('keyup', handleInputKeyup);\n    document.body.removeChild(input);\n    input = null;\n  }\n}\n\n/**\n * Set the text attributes\n *\n * @param {Number} textSize The size of the text\n * @param {String} textColor The color of the text\n */\nexport function setText(textSize = 12, textColor = '000000') {\n  _textSize = parseInt(textSize, 10);\n  _textColor = textColor;\n}\n\n/**\n * Enable text behavior\n */\nexport function enableText() {\n  if (_enabled) {\n    return;\n  }\n\n  _enabled = true;\n  document.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Disable text behavior\n */\nexport function disableText() {\n  if (!_enabled) { return; }\n\n  _enabled = false;\n  document.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n","/**\n * Create a node that is only visible to screen readers\n *\n * @param {String} content The text content that should be read by screen reader\n * @param {String} [annotationId] The ID of the annotation assocaited\n * @return {Element} An Element that is only visible to screen readers\n */\nexport default function createScreenReaderOnly(content, annotationId) {\n  let node = document.createElement('div');\n  let text = document.createTextNode(content);\n  node.appendChild(text);\n  node.setAttribute('id', `pdf-annotate-screenreader-${annotationId}`);\n  node.style.position = 'absolute';\n  node.style.left = '-10000px';\n  node.style.top = 'auto';\n  node.style.width = '1px';\n  node.style.height = '1px';\n  node.style.overflow = 'hidden';\n  return node;\n}\n","import config from '../config';\nimport {\n  pointIntersectsRect,\n  scaleUp,\n  scaleDown\n} from '../UI/utils';\n\n/**\n * Insert an element at a point within the document.\n * This algorithm will only insert within an element amidst it's text content.\n *\n * @param {Element} el The element to be inserted\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page number to limit elements to\n * @param {Boolean} insertBefore Whether the element is to be inserted before or after x\n * @return {Boolean} True if element was able to be inserted, otherwise false\n */\nexport default function insertElementWithinElement(el, x, y, pageNumber, insertBefore) {\n  const OFFSET_ADJUST = 2;\n\n  // If inserting before adjust `x` by looking for element a few px to the right\n  // Otherwise adjust a few px to the left\n  // This is to allow a little tolerance by searching within the box, instead\n  // of getting a false negative by testing right on the border.\n  x = Math.max(x + (OFFSET_ADJUST * (insertBefore ? 1 : -1)), 0);\n\n  let node = textLayerElementFromPoint(x, y + OFFSET_ADJUST, pageNumber);\n  if (!node) {\n    return false;\n  }\n\n  // Now that node has been found inverse the adjustment for `x`.\n  // This is done to accomodate tolerance by cutting off on the outside of the\n  // text boundary, instead of missing a character by cutting off within.\n  x = x + (OFFSET_ADJUST * (insertBefore ? -1 : 1));\n\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n  let left = scaleDown(svg, {left: node.getBoundingClientRect().left}).left - svg.getBoundingClientRect().left;\n  let temp = node.cloneNode(true);\n  let head = temp.innerHTML.split('');\n  let tail = [];\n\n  // Insert temp off screen\n  temp.style.position = 'absolute';\n  temp.style.top = '-10000px';\n  temp.style.left = '-10000px';\n  document.body.appendChild(temp);\n\n  while (head.length) {\n    // Don't insert within HTML tags\n    if (head[head.length - 1] === '>') {\n      while (head.length) {\n        tail.unshift(head.pop());\n        if (tail[0] === '<') {\n          break;\n        }\n      }\n    }\n\n    // Check if width of temp based on current head value satisfies x\n    temp.innerHTML = head.join('');\n    let width = scaleDown(svg, {width: temp.getBoundingClientRect().width}).width;\n    if (left + width <= x) {\n      break;\n    }\n    tail.unshift(head.pop());\n  }\n\n  // Update original node with new markup, including element to be inserted\n  node.innerHTML = head.join('') + el.outerHTML + tail.join('');\n  temp.parentNode.removeChild(temp);\n\n  return true;\n}\n\n/**\n * Get a text layer element at a given point on a page\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page to limit elements to\n * @return {Element} First text layer element found at the point\n */\nfunction textLayerElementFromPoint(x, y, pageNumber) {\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n  let rect = svg.getBoundingClientRect();\n  y = scaleUp(svg, {y}).y + rect.top;\n  x = scaleUp(svg, {x}).x + rect.left;\n  return [...svg.parentNode.querySelectorAll(config.textClassQuery() + ' [data-canvas-width]')].filter((el) => {\n    return pointIntersectsRect(x, y, el.getBoundingClientRect());\n  })[0];\n}\n","import config from '../config';\nimport insertElementWithinElement from './insertElementWithinElement';\nimport { pointIntersectsRect, scaleUp } from '../UI/utils';\n\n/**\n * Insert an element at a point within the document.\n * This algorithm will try to insert between elements if possible.\n * It will however use `insertElementWithinElement` if it is more accurate.\n *\n * @param {Element} el The element to be inserted\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page number to limit elements to\n * @return {Boolean} True if element was able to be inserted, otherwise false\n */\nexport default function insertElementWithinChildren(el, x, y, pageNumber) {\n  // Try and use most accurate method of inserting within an element\n  if (insertElementWithinElement(el, x, y, pageNumber, true)) {\n    return true;\n  }\n\n  // Fall back to inserting between elements\n  let svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n  let rect = svg.getBoundingClientRect();\n  let nodes = [...svg.parentNode.querySelectorAll(config.textClassQuery() + ' > div')];\n\n  y = scaleUp(svg, {y}).y + rect.top;\n  x = scaleUp(svg, {x}).x + rect.left;\n\n  // Find the best node to insert before\n  for (let i = 0, l = nodes.length; i < l; i++) {\n    let n = nodes[i];\n    let r = n.getBoundingClientRect();\n    if (y <= r.top) {\n      n.parentNode.insertBefore(el, n);\n      return true;\n    }\n  }\n\n  // If all else fails try to append to the bottom\n  let textLayer = svg.parentNode.querySelector(config.textClassQuery());\n  if (textLayer) {\n    let textRect = textLayer.getBoundingClientRect();\n    if (pointIntersectsRect(x, y, textRect)) {\n      textLayer.appendChild(el);\n      return true;\n    }\n  }\n\n  return false;\n}\n","/**\n * Insert a comment into the DOM to be available by screen reader\n *\n * @param {Object} comment The comment to be inserted\n */\nexport default function insertScreenReaderComment(comment) {\n  if (!comment) {\n    return;\n  }\n\n  let list = document.querySelector(`#pdf-annotate-screenreader-${comment.annotation} ol`);\n  if (list) {\n    let item = document.createElement('li');\n    item.setAttribute('id', `pdf-annotate-screenreader-comment-${comment.uuid}`);\n    item.appendChild(document.createTextNode(`${comment.content}`));\n    list.appendChild(item);\n  }\n}\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport insertScreenReaderComment from './insertScreenReaderComment';\n\n/**\n * Insert the comments into the DOM to be available by screen reader\n *\n * Example output:\n *   <div class=\"screenReaderOnly\">\n *    <div>Begin highlight 1</div>\n *    <ol aria-label=\"Comments\">\n *      <li>Foo</li>\n *      <li>Bar</li>\n *      <li>Baz</li>\n *      <li>Qux</li>\n *    </ol>\n *  </div>\n *  <div>Some highlighted text goes here...</div>\n *  <div class=\"screenReaderOnly\">End highlight 1</div>\n *\n * NOTE: `screenReaderOnly` is not a real class, just used for brevity\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The ID of the annotation\n * @param {Array} [comments] Optionally preloaded comments to be rendered\n * @return {Promise} Promise that once has comments, render them for screen reader\n */\nexport default function renderScreenReaderComments(documentId, annotationId, comments) {\n  let promise;\n\n  if (Array.isArray(comments)) {\n    promise = Promise.resolve(comments);\n  }\n  else {\n    promise = PDFJSAnnotate.getStoreAdapter().getComments(documentId, annotationId);\n  }\n\n  return promise.then((comments) => {\n    // Node needs to be found by querying DOM as it may have been inserted as innerHTML\n    // leaving `screenReaderNode` as an invalid reference (see `insertElementWithinElement`).\n    let node = document.getElementById(`pdf-annotate-screenreader-${annotationId}`);\n    if (node) {\n      let list = document.createElement('ol');\n      list.setAttribute('id', `pdf-annotate-screenreader-comment-list-${annotationId}`);\n      list.setAttribute('aria-label', 'Comments');\n      node.appendChild(list);\n      comments.forEach(insertScreenReaderComment);\n    }\n  });\n}\n","import createScreenReaderOnly from './createScreenReaderOnly';\nimport insertElementWithinChildren from './insertElementWithinChildren';\nimport insertElementWithinElement from './insertElementWithinElement';\nimport renderScreenReaderComments from './renderScreenReaderComments';\n\n// Annotation types that support comments\nconst COMMENT_TYPES = ['highlight', 'point', 'area', 'circle', 'emptycircle', 'fillcircle'];\n\n/**\n * Insert a hint into the DOM for screen readers for a specific annotation.\n *\n * @param {Object} annotation The annotation to insert a hint for\n * @param {Number} num The number of the annotation out of all annotations of the same type\n */\nexport default function insertScreenReaderHint(annotation, num = 0) {\n  switch (annotation.type) {\n    case 'highlight':\n    case 'strikeout':\n      let rects = annotation.rectangles;\n      let first = rects[0];\n      let last = rects[rects.length - 1];\n\n      insertElementWithinElement(\n        createScreenReaderOnly(`Begin ${annotation.type} annotation ${num}`, annotation.uuid),\n        first.x, first.y, annotation.page, true\n      );\n\n      insertElementWithinElement(\n        createScreenReaderOnly(`End ${annotation.type} annotation ${num}`, `${annotation.uuid}-end`),\n        last.x + last.width, last.y, annotation.page, false\n      );\n      break;\n\n    case 'textbox':\n    case 'point':\n      let text = annotation.type === 'textbox' ? ` (content: ${annotation.content})` : '';\n\n      insertElementWithinChildren(\n        createScreenReaderOnly(`${annotation.type} annotation ${num}${text}`, annotation.uuid),\n        annotation.x, annotation.y, annotation.page\n      );\n      break;\n\n    case 'drawing':\n    case 'area':\n      let x = typeof annotation.x !== 'undefined' ? annotation.x : annotation.lines[0][0];\n      let y = typeof annotation.y !== 'undefined' ? annotation.y : annotation.lines[0][1];\n\n      insertElementWithinChildren(\n        createScreenReaderOnly(`Unlabeled drawing`, annotation.uuid),\n        x, y, annotation.page\n      );\n      break;\n\n    case 'circle':\n    case 'fillcircle':\n    case 'emptycircle':\n      let x2 = typeof annotation.cx !== 'undefined' ? annotation.cx : annotation.lines[0][0];\n      let y2 = typeof annotation.cy !== 'undefined' ? annotation.cy : annotation.lines[0][1];\n\n      insertElementWithinChildren(\n        createScreenReaderOnly(`Unlabeled drawing`, annotation.uuid),\n        x2, y2, annotation.page\n      );\n      break;\n  }\n\n  // Include comments in screen reader hint\n  if (COMMENT_TYPES.includes(annotation.type)) {\n    renderScreenReaderComments(annotation.documentId, annotation.uuid);\n  }\n}\n","import renderScreenReaderHints from './renderScreenReaderHints';\nimport insertScreenReaderComment from './insertScreenReaderComment';\nimport renderScreenReaderComments from './renderScreenReaderComments';\nimport { addEventListener } from '../UI/event';\nimport PDFJSAnnotate from '../PDFJSAnnotate';\n\n/**\n * Initialize the event handlers for keeping screen reader hints synced with data\n */\nexport default function initEventHandlers() {\n  addEventListener('annotation:add', (documentId, pageNumber, annotation) => {\n    reorderAnnotationsByType(documentId, pageNumber, annotation.type);\n  });\n  addEventListener('annotation:edit', (documentId, annotationId, annotation) => {\n    reorderAnnotationsByType(documentId, annotation.page, annotation.type);\n  });\n  addEventListener('annotation:delete', removeAnnotation);\n  addEventListener('comment:add', insertComment);\n  addEventListener('comment:delete', removeComment);\n}\n\n/**\n * Reorder the annotation numbers by annotation type\n *\n * @param {String} documentId The ID of the document\n * @param {Number} pageNumber The page number of the annotations\n * @param {Strig} type The annotation type\n */\nfunction reorderAnnotationsByType(documentId, pageNumber, type) {\n  PDFJSAnnotate.getStoreAdapter().getAnnotations(documentId, pageNumber)\n    .then((annotations) => {\n      return annotations.annotations.filter((a) => {\n        return a.type === type;\n      });\n    })\n    .then((annotations) => {\n      annotations.forEach((a) => {\n        removeAnnotation(documentId, a.uuid);\n      });\n\n      return annotations;\n    })\n    .then(renderScreenReaderHints);\n}\n\n/**\n * Remove the screen reader hint for an annotation\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The Id of the annotation\n */\nfunction removeAnnotation(documentId, annotationId) {\n  removeElementById(`pdf-annotate-screenreader-${annotationId}`);\n  removeElementById(`pdf-annotate-screenreader-${annotationId}-end`);\n}\n\n/**\n * Insert a screen reader hint for a comment\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The ID of tha assocated annotation\n * @param {Object} comment The comment to insert a hint for\n */\nfunction insertComment(documentId, annotationId, comment) {\n  let list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\n  let promise;\n\n  if (!list) {\n    promise = renderScreenReaderComments(documentId, annotationId, []).then(() => {\n      list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\n      return true;\n    });\n  }\n  else {\n    promise = Promise.resolve(true);\n  }\n\n  promise.then(() => {\n    insertScreenReaderComment(comment);\n  });\n}\n\n/**\n * Remove a screen reader hint for a comment\n *\n * @param {String} documentId The ID of the document\n * @param {String} commentId The ID of the comment\n */\nfunction removeComment(documentId, commentId) {\n  removeElementById(`pdf-annotate-screenreader-comment-${commentId}`);\n}\n\n/**\n * Remove an element from the DOM by it's ID if it exists\n *\n * @param {String} elementId The ID of the element to be removed\n */\nfunction removeElementById(elementId) {\n  let el = document.getElementById(elementId);\n  if (el) {\n    el.parentNode.removeChild(el);\n  }\n}\n","import insertScreenReaderHint from './insertScreenReaderHint';\nimport initEventHandlers from './initEventHandlers';\n\n// TODO This is not the right place for this to live\ninitEventHandlers();\n\n/**\n * Insert hints into the DOM for screen readers.\n *\n * @param {Array} annotations The annotations that hints are inserted for\n */\nexport default function renderScreenReaderHints(annotations) {\n  annotations = Array.isArray(annotations) ? annotations : [];\n\n  // Insert hints for each type\n  Object.keys(SORT_TYPES).forEach((type) => {\n    let sortBy = SORT_TYPES[type];\n    annotations\n      .filter((a) => a.type === type)\n      .sort(sortBy)\n      .forEach((a, i) => insertScreenReaderHint(a, i + 1));\n  });\n}\n\n// Sort annotations first by y, then by x.\n// This allows hints to be injected in the order they appear,\n// which makes numbering them easier.\nfunction sortByPoint(a, b) {\n  if (a.y < b.y) {\n    return a.x - b.x;\n  }\n  else {\n    return 1;\n  }\n}\n\n// Sort annotation by it's first rectangle\nfunction sortByRectPoint(a, b) {\n  return sortByPoint(a.rectangles[0], b.rectangles[0]);\n}\n\n// Sort annotation by it's first line\nfunction sortByLinePoint(a, b) {\n  let lineA = a.lines[0];\n  let lineB = b.lines[0];\n  return sortByPoint(\n    {x: lineA[0], y: lineA[1]},\n    {x: lineB[0], y: lineB[1]}\n  );\n}\n\n// Arrange supported types and associated sort methods\nconst SORT_TYPES = {\n  'highlight': sortByRectPoint,\n  'strikeout': sortByRectPoint,\n  'drawing': sortByLinePoint,\n  'textbox': sortByPoint,\n  'point': sortByPoint,\n  'area': sortByPoint\n};\n\n","import PDFJSAnnotate from \"../PDFJSAnnotate\";\nimport config from \"../config\";\nimport renderScreenReaderHints from \"../a11y/renderScreenReaderHints\";\n\n// Template for creating a new page\nconst PAGE_TEMPLATE =\n  `\n  <div style=\"visibility: hidden;\" class=\"page\" data-loaded=\"false\">\n    <div class=\"canvasWrapper\">\n      <canvas></canvas>\n    </div>\n    <div class=\"` +\n  config.textLayerName +\n  `\"></div>\n    <svg class=\"` +\n  config.annotationLayerName +\n  `\"></svg>\n  </div>\n`;\n\n/**\n * Create a new page to be appended to the DOM.\n *\n * @param {Number} pageNumber The page number that is being created\n * @return {HTMLElement}\n */\nexport function createPage(pageNumber) {\n  let temp = document.createElement(\"div\");\n  temp.innerHTML = PAGE_TEMPLATE;\n\n  let page = temp.children[0];\n  let canvas = page.querySelector(\"canvas\");\n\n  page.setAttribute(\"id\", `pageContainer${pageNumber}`);\n  page.setAttribute(\"data-page-number\", pageNumber);\n\n  canvas.mozOpaque = true;\n  canvas.setAttribute(\"id\", `page${pageNumber}`);\n\n  return page;\n}\n\n/**\n * Render a page that has already been created.\n *\n * @param {Number} pageNumber The page number to be rendered\n * @param {Object} renderOptions The options for rendering\n * @return {Promise} Settled once rendering has completed\n *  A settled Promise will be either:\n *    - fulfilled: [pdfPage, annotations]\n *    - rejected: Error\n */\nexport function renderPage(pageNumber, renderOptions) {\n  let { documentId, pdfDocument, scale, rotate } = renderOptions;\n\n  const eventBus = new pdfjsViewer.EventBus();\n\n  // Load the page and annotations\n  return Promise.all([\n    pdfDocument.getPage(pageNumber),\n    PDFJSAnnotate.getAnnotations(documentId, pageNumber),\n  ]).then(([pdfPage, annotations]) => {\n    let page = document.getElementById(`pageContainer${pageNumber}`);\n    let svg = page.querySelector(config.annotationClassQuery());\n    let canvas = page.querySelector(\".canvasWrapper canvas\");\n    let canvasContext = canvas.getContext(\"2d\", { alpha: false });\n    let totalRotation = (rotate + pdfPage.rotate) % 360;\n    let viewport = pdfPage.getViewport({\n      scale: scale,\n      rotation: totalRotation,\n    });\n    let transform = scalePage(pageNumber, viewport, canvasContext);\n\n    // Render the page\n    return Promise.all([\n      pdfPage.render({ canvasContext, viewport, transform }).promise,\n      PDFJSAnnotate.render(svg, viewport, annotations),\n    ])\n      .then(() => {\n        // Text content is needed for a11y, but is also necessary for creating\n        // highlight and strikeout annotations which require selecting text.\n        return pdfPage\n          .getTextContent({ normalizeWhitespace: true })\n          .then((textContent) => {\n            return new Promise((resolve, reject) => {\n              // Render text layer for a11y of text content\n              // let textLayer = page.querySelector(config.textClassQuery());\n              // let textLayerFactory = new pdfjsViewer.DefaultTextLayerFactory();\n              // let textLayerBuilder = textLayerFactory.createTextLayerBuilder(\n              //   textLayer,\n              //   pageNumber - 1,\n              //   viewport,\n              //   false,\n              //   eventBus\n              // );\n              // textLayerBuilder.setTextContent(textContent);\n              // textLayerBuilder.render();\n\n              // Enable a11y for annotations\n              // Timeout is needed to wait for `textLayerBuilder.render`\n              setTimeout(() => {\n                try {\n                  renderScreenReaderHints(annotations.annotations);\n                  resolve();\n                } catch (e) {\n                  reject(e);\n                }\n              });\n            });\n          });\n      })\n      .then(() => {\n        // Indicate that the page was loaded\n        page.setAttribute(\"data-loaded\", \"true\");\n\n        return [pdfPage, annotations];\n      });\n  });\n}\n\n/**\n * Scale the elements of a page.\n *\n * @param {Number} pageNumber The page number to be scaled\n * @param {Object} viewport The viewport of the PDF page (see pdfPage.getViewport(scale, rotate))\n * @param {Object} context The canvas context that the PDF page is rendered to\n * @return {Array} The transform data for rendering the PDF page\n */\nfunction scalePage(pageNumber, viewport, context) {\n  let page = document.getElementById(`pageContainer${pageNumber}`);\n  let canvas = page.querySelector(\".canvasWrapper canvas\");\n  let svg = page.querySelector(config.annotationClassQuery());\n  let wrapper = page.querySelector(\".canvasWrapper\");\n  let textLayer = page.querySelector(config.textClassQuery());\n  let outputScale = getOutputScale(context);\n  let transform = !outputScale.scaled\n    ? null\n    : [outputScale.sx, 0, 0, outputScale.sy, 0, 0];\n  let sfx = approximateFraction(outputScale.sx);\n  let sfy = approximateFraction(outputScale.sy);\n\n  // Adjust width/height for scale\n  page.style.visibility = \"\";\n  canvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\n  canvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\n  canvas.style.width = roundToDivide(viewport.width, sfx[1]) + \"px\";\n  canvas.style.height = roundToDivide(viewport.height, sfx[1]) + \"px\";\n  svg.setAttribute(\"width\", viewport.width);\n  svg.setAttribute(\"height\", viewport.height);\n  svg.style.width = `${viewport.width}px`;\n  svg.style.height = `${viewport.height}px`;\n  page.style.width = `${viewport.width}px`;\n  page.style.height = `${viewport.height}px`;\n  wrapper.style.width = `${viewport.width}px`;\n  wrapper.style.height = `${viewport.height}px`;\n  textLayer.style.width = `${viewport.width}px`;\n  textLayer.style.height = `${viewport.height}px`;\n\n  return transform;\n}\n\n/**\n * Approximates a float number as a fraction using Farey sequence (max order of 8).\n *\n * @param {Number} x Positive float number\n * @return {Array} Estimated fraction: the first array item is a numerator,\n *                 the second one is a denominator.\n */\nfunction approximateFraction(x) {\n  // Fast path for int numbers or their inversions.\n  if (Math.floor(x) === x) {\n    return [x, 1];\n  }\n\n  const xinv = 1 / x;\n  const limit = 8;\n  if (xinv > limit) {\n    return [1, limit];\n  } else if (Math.floor(xinv) === xinv) {\n    return [1, xinv];\n  }\n\n  const x_ = x > 1 ? xinv : x;\n\n  // a/b and c/d are neighbours in Farey sequence.\n  let a = 0;\n  let b = 1;\n  let c = 1;\n  let d = 1;\n\n  // Limit search to order 8.\n  while (true) {\n    // Generating next term in sequence (order of q).\n    let p = a + c;\n    let q = b + d;\n    if (q > limit) {\n      break;\n    }\n    if (x_ <= p / q) {\n      c = p;\n      d = q;\n    } else {\n      a = p;\n      b = q;\n    }\n  }\n\n  // Select closest of neighbours to x.\n  if (x_ - a / b < c / d - x_) {\n    return x_ === x ? [a, b] : [b, a];\n  } else {\n    return x_ === x ? [c, d] : [d, c];\n  }\n}\n\nfunction getOutputScale(ctx) {\n  let devicePixelRatio = window.devicePixelRatio || 1;\n  let backingStoreRatio =\n    ctx.webkitBackingStorePixelRatio ||\n    ctx.mozBackingStorePixelRatio ||\n    ctx.msBackingStorePixelRatio ||\n    ctx.oBackingStorePixelRatio ||\n    ctx.backingStorePixelRatio ||\n    1;\n  let pixelRatio = devicePixelRatio / backingStoreRatio;\n  return {\n    sx: pixelRatio,\n    sy: pixelRatio,\n    scaled: pixelRatio !== 1,\n  };\n}\n\nfunction roundToDivide(x, div) {\n  let r = x % div;\n  return r === 0 ? x : Math.round(x - r + div);\n}\n","import { addEventListener, removeEventListener, fireEvent } from \"./event\";\nimport { disableEdit, enableEdit } from \"./edit\";\nimport { disablePen, enablePen, setPen } from \"./pen\";\nimport { disableArrow, enableArrow, setArrow } from \"./arrow\";\nimport { disableEraser, enableEraser } from \"./eraser\";\nimport { disablePoint, enablePoint } from \"./point\";\nimport { disableRect, enableRect } from \"./rect\";\nimport { disableCircle, enableCircle, setCircle, addCircle } from \"./circle\";\nimport { disableText, enableText, setText } from \"./text\";\nimport { createPage, renderPage } from \"./page\";\n\nexport default {\n  addEventListener,\n  removeEventListener,\n  fireEvent,\n\n  disableEdit,\n  enableEdit,\n\n  disablePen,\n  enablePen,\n  setPen,\n\n  disablePoint,\n  enablePoint,\n\n  disableRect,\n  enableRect,\n\n  disableCircle,\n  enableCircle,\n  setCircle,\n  addCircle,\n\n  disableArrow,\n  enableArrow,\n  setArrow,\n\n  disableEraser,\n  enableEraser,\n\n  disableText,\n  enableText,\n  setText,\n\n  createPage,\n  renderPage,\n};\n","import StoreAdapter from './adapter/StoreAdapter';\nimport LocalStoreAdapter from './adapter/LocalStoreAdapter';\nimport LocalUserStoreAdapter from './adapter/LocalUserStoreAdapter';\nimport render from './render';\nimport UI from './UI';\nimport config from './config';\nimport uuid from './utils/uuid';\nimport {\n  findAnnotationAtPoint,\n  findSVGContainer,\n  convertToScreenPoint\n} from './UI/utils';\n\nexport default {\n  findAnnotationAtPoint,\n  findSVGContainer,\n  convertToScreenPoint,\n\n  /**\n   * Abstract class that needs to be defined so PDFJSAnnotate\n   * knows how to communicate with your server.\n   */\n  StoreAdapter,\n\n  /**\n   * Implementation of StoreAdapter that stores annotation data to localStorage.\n   */\n  LocalStoreAdapter,\n\n  /**\n   * Implementation of StoreAdapter that stores annotation data to localStorage particular\n   * to a specific user\n   */\n  LocalUserStoreAdapter,\n\n  /**\n   * Abstract instance of StoreAdapter\n   */\n  __storeAdapter: new StoreAdapter(),\n\n  /**\n   * Getter for the underlying StoreAdapter property\n   *\n   * @return {StoreAdapter}\n   */\n  getStoreAdapter() {\n    return this.__storeAdapter;\n  },\n\n  /**\n   * Setter for the underlying StoreAdapter property\n   *\n   * @param {StoreAdapter} adapter The StoreAdapter implementation to be used.\n   */\n  setStoreAdapter(adapter) {\n    // TODO this throws an error when bundled\n    // if (!(adapter instanceof StoreAdapter)) {\n    //   throw new Error('adapter must be an instance of StoreAdapter');\n    // }\n\n    this.__storeAdapter = adapter;\n  },\n\n  /**\n   * UI is a helper for instrumenting UI interactions for creating,\n   * editing, and deleting annotations in the browser.\n   */\n  UI,\n\n  /**\n   * Render the annotations for a page in the PDF Document\n   *\n   * @param {SVGElement} svg The SVG element that annotations should be rendered to\n   * @param {PageViewport} viewport The PDFPage.getViewport data\n   * @param {Object} data The StoreAdapter.getAnnotations data\n   * @return {Promise}\n   */\n  render,\n\n  /**\n   * Convenience method for getting annotation data\n   *\n   * @alias StoreAdapter.getAnnotations\n   * @param {String} documentId The ID of the document\n   * @param {String} pageNumber The page number\n   * @return {Promise}\n   */\n  getAnnotations(documentId, pageNumber) {\n    return this.getStoreAdapter().getAnnotations(...arguments);\n  },\n\n  config,\n\n  uuid\n};\n","import { appendChild, transformChild } from './appendChild';\n\n/**\n * Render the response from PDFJSAnnotate.getStoreAdapter().getAnnotations to SVG\n *\n * @param {SVGElement} svg The SVG element to render the annotations to\n * @param {Object} viewport The page viewport data\n * @param {Object} data The response from PDFJSAnnotate.getStoreAdapter().getAnnotations\n * @return {Promise} Settled once rendering has completed\n *  A settled Promise will be either:\n *    - fulfilled: SVGElement\n *    - rejected: Error\n */\nexport default function render(svg, viewport, data) {\n  return new Promise((resolve, reject) => {\n    // Reset the content of the SVG\n    svg.setAttribute('data-pdf-annotate-container', true);\n    svg.setAttribute('data-pdf-annotate-viewport', JSON.stringify(viewport));\n    svg.removeAttribute('data-pdf-annotate-document');\n    svg.removeAttribute('data-pdf-annotate-page');\n\n    // If there's no data nothing can be done\n    if (!data) {\n      svg.innerHTML = '';\n      return resolve(svg);\n    }\n\n    svg.setAttribute('data-pdf-annotate-document', data.documentId);\n    svg.setAttribute('data-pdf-annotate-page', data.pageNumber);\n\n    // Make sure annotations is an array\n    if (!Array.isArray(data.annotations) || data.annotations.length === 0) {\n      return resolve(svg);\n    }\n\n    // Append or transform annotation to svg\n    data.annotations.forEach((a) => {\n      let node = svg.querySelector('[data-pdf-annotate-id=\"' + a.uuid + '\"]');\n      if (node) {\n        transformChild(svg, node, viewport);\n      }\n      else {\n        appendChild(svg, a, viewport);\n      }\n    });\n\n    resolve(svg);\n  });\n}\n","import PDFJSAnnotate from './src/PDFJSAnnotate';\n\nexport default PDFJSAnnotate;\n"],"sourceRoot":""}